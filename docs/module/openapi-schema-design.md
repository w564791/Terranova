# Module Schema OpenAPI v3 è®¾è®¡æ–¹æ¡ˆ

## 1. æ¦‚è¿°

æœ¬æ–‡æ¡£æè¿°äº†ä½¿ç”¨OpenAPI v3è§„èŒƒé‡æ–°è®¾è®¡Moduleå‰ç«¯æ¸²æŸ“é€»è¾‘çš„æ–¹æ¡ˆã€‚æ–°æ–¹æ¡ˆå°†æ•°æ®Schemaä¸UIæ¸²æŸ“é€»è¾‘åˆ†ç¦»ï¼Œæä¾›æ›´å¼ºå¤§çš„éªŒè¯ã€çº§è”å’ŒåŠ¨æ€æ•°æ®æ”¯æŒã€‚

## 2. å¿«é€Ÿå¼€å§‹

### 2.1 å·¥å…·å’Œç¤ºä¾‹æ–‡ä»¶

#### æ ¸å¿ƒå·¥å…·

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `backend/cmd/tools/tf2openapi/main.go` | Terraform variables.tf è½¬ OpenAPI Schema å·¥å…· |
| `docs/module/schema-form-renderer.html` | Schemaé©±åŠ¨çš„è¡¨å•æ¸²æŸ“å™¨é¢„è§ˆï¼ˆæ”¯æŒå¤–éƒ¨æ•°æ®æºæ¨¡æ‹Ÿï¼‰ |

#### è§„èŒƒæ–‡æ¡£

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `docs/module/openapi-schema-design.md` | æœ¬æ–‡æ¡£ - OpenAPI Schemaè®¾è®¡æ–¹æ¡ˆ |
| `docs/module/terraform-annotation-spec.md` | Terraformæ³¨é‡Šè§„èŒƒæ–‡æ¡£ |
| `docs/module/schema.go` | Goè¯­è¨€Schemaç±»å‹å®šä¹‰å‚è€ƒ |

#### Schemaç¤ºä¾‹æ–‡ä»¶

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `docs/module/s3-module-openapi-schema.json` | S3æ¨¡å—OpenAPI Schemaç¤ºä¾‹ |
| `docs/module/ec2-module-openapi-schema.json` | EC2æ¨¡å—OpenAPI Schemaç¤ºä¾‹ï¼ˆå«å¤–éƒ¨æ•°æ®æºï¼‰ |
| `docs/94-s3-complete-schema.json` | S3æ¨¡å—å®Œæ•´Schemaï¼ˆæ—§æ ¼å¼å‚è€ƒï¼‰ |

#### Terraformç¤ºä¾‹æ–‡ä»¶

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `scripts/ec2-module-annotated.tf` | å¸¦å®Œæ•´æ³¨é‡Šçš„EC2 variables.tfç¤ºä¾‹ |
| `demo/s3_module.go` | S3æ¨¡å—Goå®šä¹‰ç¤ºä¾‹ |
| `demo/types.go` | ç±»å‹å®šä¹‰ç¤ºä¾‹ |

### 2.2 ä½¿ç”¨tf2openapiå·¥å…·

```bash
# åŸºæœ¬ç”¨æ³•
cd backend
go run cmd/tools/tf2openapi/main.go \
  -f /path/to/variables.tf \
  -o output.json

# å®Œæ•´å‚æ•°
go run cmd/tools/tf2openapi/main.go \
  -f ../scripts/ec2-module-annotated.tf \
  -o ../docs/module/ec2-module-openapi-schema.json \
  -name "AWS EC2 Instance" \
  -version "5.0.0" \
  -source "terraform-aws-modules/ec2-instance/aws" \
  -provider "aws" \
  -layout "top"
```

**å‚æ•°è¯´æ˜ï¼š**
| å‚æ•° | å¿…å¡« | è¯´æ˜ |
|------|------|------|
| `-f` | æ˜¯ | è¾“å…¥çš„variables.tfæ–‡ä»¶è·¯å¾„ |
| `-o` | æ˜¯ | è¾“å‡ºçš„JSON Schemaæ–‡ä»¶è·¯å¾„ |
| `-name` | å¦ | æ¨¡å—åç§°ï¼ˆé»˜è®¤ä½¿ç”¨ç›®å½•åï¼‰ |
| `-version` | å¦ | æ¨¡å—ç‰ˆæœ¬ï¼ˆé»˜è®¤1.0.0ï¼‰ |
| `-source` | å¦ | Terraformæ¨¡å—æº |
| `-provider` | å¦ | Provideråç§°ï¼ˆaws/azure/gcpï¼‰ |
| `-layout` | å¦ | Tabå¸ƒå±€ä½ç½®ï¼štop/leftï¼ˆé»˜è®¤topï¼‰ |

### 2.3 é¢„è§ˆSchemaæ¸²æŸ“æ•ˆæœ

**æ–¹æ³•ä¸€ï¼šç›´æ¥æ‰“å¼€HTMLæ–‡ä»¶**
1. åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ `docs/module/schema-form-renderer.html`
2. é€‰æ‹©é¢„è®¾çš„Schemaæ–‡ä»¶æˆ–ä¸Šä¼ è‡ªå®šä¹‰JSON
3. ç‚¹å‡»"åŠ è½½Schemaå¹¶æ¸²æŸ“è¡¨å•"
4. åˆ‡æ¢TabæŸ¥çœ‹åŸºç¡€é…ç½®å’Œé«˜çº§é…ç½®

**æ–¹æ³•äºŒï¼šä½¿ç”¨HTTPæœåŠ¡å™¨ï¼ˆæ¨èï¼‰**
```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•å¯åŠ¨HTTPæœåŠ¡å™¨
cd /path/to/iac-platform
python3 -m http.server 8888

# ç„¶ååœ¨æµè§ˆå™¨ä¸­è®¿é—®
open http://localhost:8888/docs/module/schema-form-renderer.html
```

> ä½¿ç”¨HTTPæœåŠ¡å™¨å¯ä»¥é¿å…æµè§ˆå™¨çš„è·¨åŸŸé™åˆ¶ï¼Œæ”¯æŒåŠ è½½æœ¬åœ°JSONæ–‡ä»¶ã€‚

## 3. åˆé˜¶ä¸é«˜é˜¶é…ç½®å®šä¹‰

### 3.1 æ¦‚å¿µè¯´æ˜

æ¨¡å—å‚æ•°åˆ†ä¸ºä¸¤ä¸ªçº§åˆ«ï¼Œç”¨äºä¼˜åŒ–ç”¨æˆ·ä½“éªŒï¼š

| çº§åˆ« | æ ‡è¯† | è¯´æ˜ | é€‚ç”¨åœºæ™¯ |
|------|------|------|----------|
| **åˆé˜¶é…ç½® (basic)** | `@level:basic` | æœ€å¸¸ç”¨ã€æœ€åŸºç¡€çš„å‚æ•° | æ–°æ‰‹ç”¨æˆ·ã€å¿«é€Ÿéƒ¨ç½²ã€80%çš„ä½¿ç”¨åœºæ™¯ |
| **é«˜é˜¶é…ç½® (advanced)** | `@level:advanced` æˆ–é»˜è®¤ | é«˜çº§å‚æ•°ã€è°ƒä¼˜é€‰é¡¹ã€è¾¹ç¼˜åœºæ™¯ | ä¸“å®¶ç”¨æˆ·ã€ç‰¹æ®Šéœ€æ±‚ã€ç²¾ç»†åŒ–é…ç½® |

### 3.2 åˆ†ç±»åŸåˆ™

#### åˆé˜¶é…ç½® (basic) åº”åŒ…å«ï¼š

1. **å¿…å¡«å‚æ•°** - æ²¡æœ‰é»˜è®¤å€¼ï¼Œå¿…é¡»ç”±ç”¨æˆ·æä¾›
2. **æ ¸å¿ƒæ ‡è¯†å‚æ•°** - å¦‚ `name`ã€`bucket`ã€`instance_type`
3. **å¸¸ç”¨é…ç½®** - 80%ç”¨æˆ·éƒ½ä¼šä¿®æ”¹çš„å‚æ•°
4. **å®‰å…¨ç›¸å…³** - å¦‚ `vpc_security_group_ids`ã€`kms_key_id`
5. **æˆæœ¬ç›¸å…³** - å¦‚ `instance_type`ã€`volume_size`

#### é«˜é˜¶é…ç½® (advanced) åº”åŒ…å«ï¼š

1. **æœ‰åˆç†é»˜è®¤å€¼çš„å‚æ•°** - å¤§å¤šæ•°æƒ…å†µä¸‹ä¸éœ€è¦ä¿®æ”¹
2. **è°ƒä¼˜å‚æ•°** - å¦‚ `timeout`ã€`retry`ã€`buffer_size`
3. **è¾¹ç¼˜åœºæ™¯å‚æ•°** - å¦‚ `force_destroy`ã€`skip_final_snapshot`
4. **å†…éƒ¨å‚æ•°** - å¦‚ `internal_*`ã€`override_*`
5. **å¼ƒç”¨å‚æ•°** - æ ‡è®°ä¸º `deprecated` çš„å‚æ•°
6. **å®éªŒæ€§å‚æ•°** - å¦‚ `experimental_*`

### 3.3 EC2æ¨¡å—åˆ†ç±»ç¤ºä¾‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    åˆé˜¶é…ç½® (basic) - 9ä¸ª                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  name                    å®ä¾‹åç§°                            â”‚
â”‚  ami                     AMIé•œåƒID                          â”‚
â”‚  instance_type           å®ä¾‹ç±»å‹ (t3.microç­‰)               â”‚
â”‚  key_name                SSHå¯†é’¥å¯¹åç§°                       â”‚
â”‚  subnet_id               å­ç½‘ID                             â”‚
â”‚  vpc_security_group_ids  å®‰å…¨ç»„IDåˆ—è¡¨                        â”‚
â”‚  associate_public_ip     æ˜¯å¦åˆ†é…å…¬ç½‘IP                      â”‚
â”‚  iam_instance_profile    IAMå®ä¾‹é…ç½®æ–‡ä»¶                     â”‚
â”‚  tags                    èµ„æºæ ‡ç­¾                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   é«˜é˜¶é…ç½® (advanced) - 54ä¸ª                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  availability_zone       å¯ç”¨åŒº                              â”‚
â”‚  cpu_credits             CPUç§¯åˆ†æ¨¡å¼                         â”‚
â”‚  disable_api_termination ç¦ç”¨APIç»ˆæ­¢                         â”‚
â”‚  ebs_optimized           EBSä¼˜åŒ–                            â”‚
â”‚  enclave_options_enabled Enclaveé€‰é¡¹                        â”‚
â”‚  hibernation             ä¼‘çœ æ”¯æŒ                            â”‚
â”‚  host_id                 ä¸“ç”¨ä¸»æœºID                          â”‚
â”‚  instance_initiated_shutdown_behavior  å…³æœºè¡Œä¸º              â”‚
â”‚  monitoring              è¯¦ç»†ç›‘æ§                            â”‚
â”‚  placement_group         ç½®æ”¾ç¾¤ç»„                            â”‚
â”‚  private_ip              ç§æœ‰IP                             â”‚
â”‚  root_block_device       æ ¹å·é…ç½®                            â”‚
â”‚  ebs_block_device        EBSå·é…ç½®                          â”‚
â”‚  ephemeral_block_device  ä¸´æ—¶å·é…ç½®                          â”‚
â”‚  network_interface       ç½‘ç»œæ¥å£é…ç½®                        â”‚
â”‚  ... (æ›´å¤šé«˜çº§å‚æ•°)                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.4 UIå±•ç¤ºæ•ˆæœ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âš™ï¸ åŸºç¡€é…ç½®  â”‚  ğŸ’» é«˜çº§é…ç½®                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  å®ä¾‹åç§° *                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ my-ec2-instance                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  AMIé•œåƒ                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â–¼ Amazon Linux 2 AMI (ami-0123456789abcdef0)       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  é€‰æ‹©EC2å®ä¾‹ä½¿ç”¨çš„AMIé•œåƒ                                    â”‚
â”‚                                                             â”‚
â”‚  å®ä¾‹ç±»å‹                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â–¼ t3.micro (2 vCPU, 1024 MB)                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  å®‰å…¨ç»„                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚  â”‚ sg-web    Ã—  â”‚ â”‚ sg-ssh    Ã—  â”‚  [+ æ·»åŠ ]              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                                                             â”‚
â”‚  æ ‡ç­¾                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Environment â”‚ production â”‚ âœ•                        â”‚   â”‚
â”‚  â”‚ Team        â”‚ platform   â”‚ âœ•                        â”‚   â”‚
â”‚  â”‚ [+ æ·»åŠ æ ‡ç­¾]                                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 4. Terraformæ³¨é‡Šè§„èŒƒ

### 4.1 è¡Œå°¾æ³¨é‡Šæ ¼å¼

åœ¨Terraform `variables.tf` æ–‡ä»¶ä¸­ï¼Œä½¿ç”¨è¡Œå°¾æ³¨é‡Šæ ‡è®°å˜é‡å±æ€§ï¼š

```hcl
variable "name" {
  description = "Name to be used on EC2 instance"  # @level:basic alias:å®ä¾‹åç§°
  type        = string
  default     = ""
}

variable "ami" {
  description = "ID of AMI to use"  # @level:basic force_new:true conflicts_with:ami_ssm_parameter
  type        = string
  default     = null

  validation {
    condition     = var.ami == null || can(regex("^ami-", var.ami))
    error_message = "AMI ID must start with 'ami-'."
  }
}
```

### 4.2 æ”¯æŒçš„æ³¨é‡Šå±æ€§

| å±æ€§ | ç¤ºä¾‹ | è¯´æ˜ |
|------|------|------|
| `level` | `@level:basic` | åˆ†ç»„çº§åˆ«ï¼šbasicï¼ˆåŸºç¡€é…ç½®ï¼‰æˆ– advancedï¼ˆé«˜çº§é…ç½®ï¼‰ |
| `group` | `@group:storage` | è‡ªå®šä¹‰åˆ†ç»„ID |
| `alias` | `@alias:å®ä¾‹åç§°` | ä¸­æ–‡åˆ«åï¼Œç”¨äºUIæ˜¾ç¤º |
| `widget` | `@widget:select` | UIæ§ä»¶ç±»å‹ |
| `computed` | `@computed:true` | è®¡ç®—å­—æ®µï¼ˆåªè¯»ï¼‰ |
| `force_new` | `@force_new:true` | å˜æ›´éœ€è¦é‡å»ºèµ„æº |
| `deprecated` | `@deprecated:Use_xxx` | å¼ƒç”¨è­¦å‘Š |
| `hidden` | `@hidden:true` | é»˜è®¤éšè— |
| `conflicts_with` | `@conflicts_with:a,b` | å†²çªå­—æ®µåˆ—è¡¨ |
| `required_with` | `@required_with:x` | ä¾èµ–å­—æ®µåˆ—è¡¨ |
| `placeholder` | `@placeholder:/dev/sdf` | è¾“å…¥æ¡†å ä½ç¬¦ |
| `enum` | `@enum:a,b,c` | æšä¸¾å€¼åˆ—è¡¨ |
| `min` | `@min:0` | æœ€å°å€¼ |
| `max` | `@max:100` | æœ€å¤§å€¼ |

### 4.3 åµŒå¥—å¯¹è±¡å±æ€§æ³¨é‡Š

```hcl
variable "root_block_device" {
  description = "Root block device config"  # @group:storage widget:object alias:æ ¹å·é…ç½®
  type = list(object({
    delete_on_termination = optional(bool, true)   # @alias:ç»ˆæ­¢æ—¶åˆ é™¤
    encrypted             = optional(bool, true)   # @alias:åŠ å¯†
    volume_size           = optional(number, 20)   # @alias:å·å¤§å°(GB) min:8 max:16384
    volume_type           = optional(string, "gp3") # @alias:å·ç±»å‹ widget:select enum:gp2,gp3,io1,io2
  }))
  default = []
}
```

### 4.4 å¿…å¡«å­—æ®µåˆ¤æ–­è§„åˆ™

åœ¨Terraformä¸­ï¼Œå˜é‡çš„å¿…å¡«æ€§ç”±æ˜¯å¦å®šä¹‰`default`å±æ€§å†³å®šï¼š

| æƒ…å†µ | æ˜¯å¦å¿…å¡« |
|------|----------|
| æ²¡æœ‰`default`å±æ€§ | âœ… å¿…å¡« |
| `default = null` | âŒ éå¿…å¡« |
| `default = ""` | âŒ éå¿…å¡« |
| `default = []` | âŒ éå¿…å¡« |
| `default = {}` | âŒ éå¿…å¡« |

## 5. æ¶æ„è®¾è®¡

### 5.1 æ•´ä½“ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Module Schema Definition                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  OpenAPI Schema â”‚  â”‚  x-iac-platform â”‚  â”‚   Metadata  â”‚ â”‚
â”‚  â”‚  (æ ‡å‡†JSON      â”‚  â”‚  (å¹³å°æ‰©å±•)      â”‚  â”‚   (å…ƒæ•°æ®)   â”‚ â”‚
â”‚  â”‚   Schema)       â”‚  â”‚                 â”‚  â”‚             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚           â”‚                    â”‚                   â”‚        â”‚
â”‚           â–¼                    â–¼                   â–¼        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                    Schema Processor                      â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚â”‚
â”‚  â”‚  â”‚Validator â”‚ â”‚UI Builderâ”‚ â”‚Cascade   â”‚ â”‚External  â”‚   â”‚â”‚
â”‚  â”‚  â”‚Engine    â”‚ â”‚Engine    â”‚ â”‚Engine    â”‚ â”‚Data Mgr  â”‚   â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 Schemaå±‚çº§

```yaml
ModuleSchema:
  openapi: "3.1.0"           # OpenAPIç‰ˆæœ¬
  info:                       # æ¨¡å—ä¿¡æ¯
    title: "S3 Module"
    version: "1.0.0"
    description: "AWS S3 Bucket Module"
    x-module-source: "terraform-aws-modules/s3-bucket/aws"
    x-provider: "aws"
  components:
    schemas:                  # æ ‡å‡†JSON Schemaå®šä¹‰
      ModuleInput:            # è¾“å…¥å‚æ•°Schema
        type: object
        properties: {}
        required: []
  x-iac-platform:            # å¹³å°æ‰©å±•
    ui:                      # UIé…ç½®
      fields: {}             # å­—æ®µUIé…ç½®
      groups: []             # åˆ†ç»„é…ç½®
      layout: {}             # å¸ƒå±€é…ç½®
    validation: {}           # éªŒè¯è§„åˆ™
    cascade: {}              # çº§è”è§„åˆ™
    external: {}             # å¤–éƒ¨æ•°æ®æº
    terraform: {}            # Terraformç‰¹å®šé…ç½®
```

## 6. æ•°æ®ç±»å‹æ˜ å°„

### 6.1 ValueType å®Œæ•´å®šä¹‰

å¹³å°å®šä¹‰äº†ä»¥ä¸‹å€¼ç±»å‹ï¼ˆValueTypeï¼‰ï¼Œç”¨äºç²¾ç¡®æ§åˆ¶å‰ç«¯æ¸²æŸ“è¡Œä¸ºå’Œæ•°æ®éªŒè¯ï¼š

```go
const (
    TypeInvalid    ValueType = iota  // 0: æ— æ•ˆç±»å‹
    TypeBool                         // 1: å¸ƒå°”å€¼
    TypeInt                          // 2: æ•´æ•°
    TypeFloat                        // 3: æµ®ç‚¹æ•°
    TypeString                       // 4: å­—ç¬¦ä¸²
    TypeList                         // 5: åˆ—è¡¨
    TypeMap                          // 6: é”®å€¼å¯¹æ˜ å°„
    TypeSet                          // 7: é›†åˆ
    TypeObject                       // 8: å¯¹è±¡
    TypeJsonString                   // 9: JSONå­—ç¬¦ä¸²
    TypeText                         // 10: å¤šè¡Œæ–‡æœ¬
    TypeListObject                   // 11: å¯¹è±¡åˆ—è¡¨
    CustomObject                     // 12: åŠ¨æ€é”®å¯¹è±¡
)
```

### 6.2 ValueType è¯¦ç»†è¯´æ˜

#### TypeBool (1) - å¸ƒå°”å€¼

| å±æ€§ | è¯´æ˜ |
|------|------|
| **æè¿°** | åªæœ‰æ˜¯æˆ–å¦ä¸¤ç§çŠ¶æ€ |
| **å‰ç«¯æ¸²æŸ“** | å¼€å…³ï¼ˆSwitchï¼‰ç»„ä»¶ |
| **OpenAPIç±»å‹** | `boolean` |
| **å…¸å‹åœºæ™¯** | å¯ç”¨/ç¦ç”¨åŠŸèƒ½å¼€å…³ï¼Œå¦‚ `enable_versioning`ã€`force_destroy` |

```json
{
  "enable_versioning": {
    "type": "boolean",
    "title": "å¯ç”¨ç‰ˆæœ¬æ§åˆ¶",
    "default": false
  }
}
```

**UIæ¸²æŸ“æ•ˆæœï¼š**
```
å¯ç”¨ç‰ˆæœ¬æ§åˆ¶  [â—‹ å…³é—­ / â— å¼€å¯]
```

---

#### TypeInt (2) - æ•´æ•°

| å±æ€§ | è¯´æ˜ |
|------|------|
| **æè¿°** | æ•°å€¼ç±»å‹ï¼Œæ”¯æŒå¢å‡æ“ä½œ |
| **å‰ç«¯æ¸²æŸ“** | æ•°å­—è¾“å…¥æ¡†ï¼Œå¸¦ä¸Šä¸‹ä¸‰è§’ç®­å¤´ï¼Œæ”¯æŒæ‰‹åŠ¨è¾“å…¥ |
| **OpenAPIç±»å‹** | `integer` + `format: int64` |
| **å…¸å‹åœºæ™¯** | EBSç£ç›˜å®¹é‡ã€å®ä¾‹æ•°é‡ã€ç«¯å£å· |

```json
{
  "volume_size": {
    "type": "integer",
    "format": "int64",
    "title": "ç£ç›˜å®¹é‡(GB)",
    "default": 20,
    "minimum": 8,
    "maximum": 16384
  }
}
```

**UIæ¸²æŸ“æ•ˆæœï¼š**
```
ç£ç›˜å®¹é‡(GB)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 20                  â–²â–¼  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
æœ€å°å€¼: 8, æœ€å¤§å€¼: 16384
```

---

#### TypeFloat (3) - æµ®ç‚¹æ•°

| å±æ€§ | è¯´æ˜ |
|------|------|
| **æè¿°** | æµ®ç‚¹æ•°å€¼ç±»å‹ |
| **å‰ç«¯æ¸²æŸ“** | æ•°å­—è¾“å…¥æ¡†ï¼Œæ”¯æŒå°æ•°è¾“å…¥ |
| **OpenAPIç±»å‹** | `number` + `format: double` |
| **å…¸å‹åœºæ™¯** | ç™¾åˆ†æ¯”ã€æƒé‡å€¼ã€ä»·æ ¼ |

```json
{
  "cpu_credits": {
    "type": "number",
    "format": "double",
    "title": "CPUç§¯åˆ†",
    "default": 0.0
  }
}
```

---

#### TypeString (4) - å­—ç¬¦ä¸²

| å±æ€§ | è¯´æ˜ |
|------|------|
| **æè¿°** | å­—ç¬¦ä¸²ç±»å‹ï¼Œé»˜è®¤ä¸ºç”¨æˆ·è¾“å…¥ï¼Œå¯é…ç½®å¤–éƒ¨æ•°æ®æº |
| **å‰ç«¯æ¸²æŸ“** | æ–‡æœ¬è¾“å…¥æ¡†ï¼ˆé»˜è®¤ï¼‰æˆ–ä¸‹æ‹‰é€‰æ‹©æ¡†ï¼ˆé…ç½®æ•°æ®æºæ—¶ï¼‰ |
| **OpenAPIç±»å‹** | `string` |
| **å…¸å‹åœºæ™¯** | åç§°ã€IDã€å¯†é’¥åç§°ï¼ˆå¦‚EC2çš„key_nameï¼‰ |

**åœºæ™¯1ï¼šçº¯æ–‡æœ¬è¾“å…¥**
```json
{
  "name": {
    "type": "string",
    "title": "å®ä¾‹åç§°",
    "default": ""
  }
}
```

**åœºæ™¯2ï¼šå¸¦å¤–éƒ¨æ•°æ®æºçš„ä¸‹æ‹‰é€‰æ‹©**
```json
{
  "key_name": {
    "type": "string",
    "title": "SSHå¯†é’¥å¯¹",
    "x-source": "key_pairs"
  }
}
```

**UIæ¸²æŸ“æ•ˆæœï¼ˆå¸¦æ•°æ®æºï¼‰ï¼š**
```
SSHå¯†é’¥å¯¹
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â–¼ my-key-pair                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   my-key-pair                       â”‚
â”‚   production-key                    â”‚
â”‚   dev-key                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

#### TypeList (5) - åˆ—è¡¨

| å±æ€§ | è¯´æ˜ |
|------|------|
| **æè¿°** | åˆ—è¡¨ç±»å‹ï¼Œæ”¯æŒå¤šé€‰æˆ–å¤šè¡Œè¾“å…¥ |
| **å‰ç«¯æ¸²æŸ“** | å¤šé€‰ä¸‹æ‹‰æ¡†ï¼ˆé…ç½®æ•°æ®æºæ—¶ï¼‰æˆ–æ ‡ç­¾è¾“å…¥ï¼ˆTagsç»„ä»¶ï¼‰ |
| **OpenAPIç±»å‹** | `array` + `items.type: string` |
| **å…¸å‹åœºæ™¯** | å®‰å…¨ç»„IDåˆ—è¡¨ã€å­ç½‘IDåˆ—è¡¨ |

**åœºæ™¯1ï¼šå¸¦æ•°æ®æºçš„å¤šé€‰**
```json
{
  "vpc_security_group_ids": {
    "type": "array",
    "items": { "type": "string" },
    "title": "å®‰å…¨ç»„",
    "x-source": "security_groups",
    "x-widget": "multi-select"
  }
}
```

**åœºæ™¯2ï¼šæ ‡ç­¾è¾“å…¥ï¼ˆæ— æ•°æ®æºï¼‰**
```json
{
  "availability_zones": {
    "type": "array",
    "items": { "type": "string" },
    "title": "å¯ç”¨åŒº",
    "x-widget": "tags"
  }
}
```

**UIæ¸²æŸ“æ•ˆæœï¼ˆå¤šé€‰ï¼‰ï¼š**
```
å®‰å…¨ç»„
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ sg-web    Ã—  â”‚ â”‚ sg-ssh    Ã—  â”‚ â”‚ + æ·»åŠ        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

#### TypeMap (6) - é”®å€¼å¯¹æ˜ å°„

| å±æ€§ | è¯´æ˜ |
|------|------|
| **æè¿°** | Mapç±»å‹ï¼Œç”¨æˆ·å¯è‡ªç”±å¢åŠ é”®å€¼å¯¹ |
| **å‰ç«¯æ¸²æŸ“** | é”®å€¼å¯¹ç¼–è¾‘å™¨ï¼ˆKey-Value Editorï¼‰ |
| **OpenAPIç±»å‹** | `object` + `additionalProperties: { type: string }` |
| **å…¸å‹åœºæ™¯** | èµ„æºæ ‡ç­¾ï¼ˆtagsï¼‰ã€ç¯å¢ƒå˜é‡ |

```json
{
  "tags": {
    "type": "object",
    "title": "èµ„æºæ ‡ç­¾",
    "additionalProperties": { "type": "string" },
    "default": {}
  }
}
```

**UIæ¸²æŸ“æ•ˆæœï¼š**
```
èµ„æºæ ‡ç­¾
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Key           â”‚  Value         â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Environment   â”‚  production    â”‚  âœ•                â”‚
â”‚  Team          â”‚  platform      â”‚  âœ•                â”‚
â”‚  [+ æ·»åŠ æ ‡ç­¾]                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

#### TypeSet (7) - é›†åˆ

| å±æ€§ | è¯´æ˜ |
|------|------|
| **æè¿°** | ä¸Listç±»ä¼¼ï¼Œä½†å…ƒç´ å”¯ä¸€ï¼ŒTerraformä¸­å¯ç”¨äºfor_eachå¾ªç¯ |
| **å‰ç«¯æ¸²æŸ“** | ä¸TypeListç›¸åŒï¼ˆæ ‡ç­¾è¾“å…¥æˆ–å¤šé€‰ï¼‰ |
| **OpenAPIç±»å‹** | `array` + `items.type: string` + `uniqueItems: true` |
| **å…¸å‹åœºæ™¯** | éœ€è¦å»é‡çš„åˆ—è¡¨ï¼Œå¦‚IAMç­–ç•¥ARNé›†åˆ |

```json
{
  "policy_arns": {
    "type": "array",
    "items": { "type": "string" },
    "uniqueItems": true,
    "title": "ç­–ç•¥ARNåˆ—è¡¨"
  }
}
```

> **æ³¨æ„**ï¼šTypeSetä¸TypeListçš„ä¸»è¦åŒºåˆ«åœ¨äºTerraformå±‚é¢ï¼ŒSetç±»å‹æ”¯æŒ`for_each`å¾ªç¯ï¼Œä¸”å…ƒç´ é¡ºåºä¸æ•æ„Ÿã€‚å‰ç«¯æ¸²æŸ“è¡Œä¸ºåŸºæœ¬ä¸€è‡´ã€‚

---

#### TypeObject (8) - å¯¹è±¡

| å±æ€§ | è¯´æ˜ |
|------|------|
| **æè¿°** | å¯¹è±¡ç±»å‹ï¼ŒKeyç”±å¹³å°å®šä¹‰ï¼ˆç”¨æˆ·ä¸å¯ä¿®æ”¹ï¼‰ï¼ŒValueå¯ä»¥æ˜¯ä»»æ„ç±»å‹ |
| **å‰ç«¯æ¸²æŸ“** | å¯¹è±¡ç¼–è¾‘å™¨ï¼ˆObject Editorï¼‰ï¼ŒæŒ‰Schemaå®šä¹‰çš„å±æ€§æ¸²æŸ“ |
| **OpenAPIç±»å‹** | `object` + `properties: {...}` |
| **å…¸å‹åœºæ™¯** | æ ¹å·é…ç½®ã€ç½‘ç»œæ¥å£é…ç½® |

```json
{
  "root_block_device": {
    "type": "object",
    "title": "æ ¹å·é…ç½®",
    "properties": {
      "volume_size": {
        "type": "integer",
        "title": "å·å¤§å°(GB)",
        "default": 20,
        "minimum": 8,
        "maximum": 16384
      },
      "volume_type": {
        "type": "string",
        "title": "å·ç±»å‹",
        "enum": ["gp2", "gp3", "io1", "io2"],
        "default": "gp3"
      },
      "encrypted": {
        "type": "boolean",
        "title": "åŠ å¯†",
        "default": true
      },
      "delete_on_termination": {
        "type": "boolean",
        "title": "ç»ˆæ­¢æ—¶åˆ é™¤",
        "default": true
      }
    }
  }
}
```

**UIæ¸²æŸ“æ•ˆæœï¼š**
```
æ ¹å·é…ç½®
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å·å¤§å°(GB)                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ 20                                      â–²â–¼  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                     â”‚
â”‚  å·ç±»å‹                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ â–¼ gp3                                       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                     â”‚
â”‚  åŠ å¯†                    [â— å¼€å¯]                    â”‚
â”‚  ç»ˆæ­¢æ—¶åˆ é™¤              [â— å¼€å¯]                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

#### TypeJsonString (9) - JSONå­—ç¬¦ä¸²

| å±æ€§ | è¯´æ˜ |
|------|------|
| **æè¿°** | ç‰¹æ®Šçš„å­—ç¬¦ä¸²ç±»å‹ï¼Œå†…å®¹ä¸ºJSONæ ¼å¼ |
| **å‰ç«¯æ¸²æŸ“** | JSON IDEç¼–è¾‘å™¨ï¼Œæ”¯æŒè¯­æ³•é«˜äº®ã€æ ¼å¼åŒ–ã€éªŒè¯ |
| **OpenAPIç±»å‹** | `string` + `format: json` æˆ– `contentMediaType: application/json` |
| **å…¸å‹åœºæ™¯** | IAMç­–ç•¥æ–‡æ¡£ã€Lambdaå‡½æ•°é…ç½® |

```json
{
  "policy_document": {
    "type": "string",
    "format": "json",
    "title": "IAMç­–ç•¥æ–‡æ¡£",
    "x-widget": "json-editor"
  }
}
```

**UIæ¸²æŸ“æ•ˆæœï¼š**
```
IAMç­–ç•¥æ–‡æ¡£
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1  {                                                â”‚
â”‚ 2    "Version": "2012-10-17",                       â”‚
â”‚ 3    "Statement": [                                 â”‚
â”‚ 4      {                                            â”‚
â”‚ 5        "Effect": "Allow",                         â”‚
â”‚ 6        "Action": "s3:GetObject",                  â”‚
â”‚ 7        "Resource": "*"                            â”‚
â”‚ 8      }                                            â”‚
â”‚ 9    ]                                              â”‚
â”‚ 10 }                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
[æ ¼å¼åŒ–] [éªŒè¯]
```

---

#### TypeText (10) - å¤šè¡Œæ–‡æœ¬

| å±æ€§ | è¯´æ˜ |
|------|------|
| **æè¿°** | çº¯æ–‡æœ¬è¾“å…¥ï¼Œæ”¯æŒå¤šè¡Œ |
| **å‰ç«¯æ¸²æŸ“** | å¤šè¡Œæ–‡æœ¬æ¡†ï¼ˆTextareaï¼‰ |
| **OpenAPIç±»å‹** | `string` + `format: textarea` æˆ– `x-widget: textarea` |
| **å…¸å‹åœºæ™¯** | EC2 User Dataã€å¯åŠ¨è„šæœ¬ã€é…ç½®æ–‡ä»¶å†…å®¹ |

```json
{
  "user_data": {
    "type": "string",
    "title": "User Data",
    "description": "EC2å®ä¾‹å¯åŠ¨è„šæœ¬",
    "x-widget": "textarea"
  }
}
```

**UIæ¸²æŸ“æ•ˆæœï¼š**
```
User Data
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ #!/bin/bash                                         â”‚
â”‚ yum update -y                                       â”‚
â”‚ yum install -y httpd                                â”‚
â”‚ systemctl start httpd                               â”‚
â”‚ systemctl enable httpd                              â”‚
â”‚                                                     â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
EC2å®ä¾‹å¯åŠ¨è„šæœ¬
```

---

#### TypeListObject (11) - å¯¹è±¡åˆ—è¡¨

| å±æ€§ | è¯´æ˜ |
|------|------|
| **æè¿°** | å¤šä¸ªTypeObjectçš„ç»„åˆï¼Œå³å¯¹è±¡æ•°ç»„ |
| **å‰ç«¯æ¸²æŸ“** | å¯¹è±¡åˆ—è¡¨ç¼–è¾‘å™¨ï¼ˆObject List Editorï¼‰ï¼Œæ”¯æŒæ·»åŠ /åˆ é™¤/æ’åº |
| **OpenAPIç±»å‹** | `array` + `items: { type: object, properties: {...} }` |
| **å…¸å‹åœºæ™¯** | EBSå·é…ç½®åˆ—è¡¨ã€ç½‘ç»œæ¥å£åˆ—è¡¨ã€å…¥ç«™è§„åˆ™åˆ—è¡¨ |

```json
{
  "ebs_block_device": {
    "type": "array",
    "title": "EBSå·é…ç½®",
    "items": {
      "type": "object",
      "properties": {
        "device_name": {
          "type": "string",
          "title": "è®¾å¤‡åç§°",
          "default": "/dev/sdf"
        },
        "volume_size": {
          "type": "integer",
          "title": "å·å¤§å°(GB)",
          "default": 20
        },
        "volume_type": {
          "type": "string",
          "title": "å·ç±»å‹",
          "enum": ["gp2", "gp3", "io1", "io2"],
          "default": "gp3"
        },
        "encrypted": {
          "type": "boolean",
          "title": "åŠ å¯†",
          "default": true
        }
      }
    }
  }
}
```

**UIæ¸²æŸ“æ•ˆæœï¼š**
```
EBSå·é…ç½®
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ #1                                          [âœ•] â”‚ â”‚
â”‚ â”‚ è®¾å¤‡åç§°: /dev/sdf                              â”‚ â”‚
â”‚ â”‚ å·å¤§å°: 20 GB                                   â”‚ â”‚
â”‚ â”‚ å·ç±»å‹: gp3                                     â”‚ â”‚
â”‚ â”‚ åŠ å¯†: âœ“                                         â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ #2                                          [âœ•] â”‚ â”‚
â”‚ â”‚ è®¾å¤‡åç§°: /dev/sdg                              â”‚ â”‚
â”‚ â”‚ å·å¤§å°: 100 GB                                  â”‚ â”‚
â”‚ â”‚ å·ç±»å‹: io1                                     â”‚ â”‚
â”‚ â”‚ åŠ å¯†: âœ“                                         â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                     â”‚
â”‚ [+ æ·»åŠ EBSå·]                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

#### CustomObject (12) - åŠ¨æ€é”®å¯¹è±¡

| å±æ€§ | è¯´æ˜ |
|------|------|
| **æè¿°** | ç‰¹æ®Šçš„å¯¹è±¡ç±»å‹ï¼ŒKeyä¸ºéšæœºç”Ÿæˆçš„æ ‡è¯†ç¬¦ï¼ŒValueä¸ºå›ºå®šçš„TypeObjectç»“æ„ |
| **å‰ç«¯æ¸²æŸ“** | åŠ¨æ€é”®å¯¹è±¡ç¼–è¾‘å™¨ï¼Œæ–°å»ºæ—¶è‡ªåŠ¨ç”ŸæˆKey |
| **Keyç”Ÿæˆè§„åˆ™** | 8-15ä½éšæœºå­—ç¬¦ä¸²ï¼Œåªèƒ½åŒ…å«å°å†™å­—æ¯å’Œä¸­æ¨ªçº¿ |
| **OpenAPIç±»å‹** | `object` + `additionalProperties: { type: object, properties: {...} }` + `x-dynamic-keys: true` |
| **å…¸å‹åœºæ™¯** | å¤šä¸ªå‘½åèµ„æºé…ç½®ï¼ˆå¦‚å¤šä¸ªS3å­˜å‚¨æ¡¶ç­–ç•¥ã€å¤šä¸ªLambdaè§¦å‘å™¨ï¼‰ |

```json
{
  "bucket_policies": {
    "type": "object",
    "title": "å­˜å‚¨æ¡¶ç­–ç•¥",
    "x-dynamic-keys": true,
    "x-key-pattern": "^[a-z][a-z0-9-]{7,14}$",
    "x-key-generator": "random-lowercase-hyphen",
    "additionalProperties": {
      "type": "object",
      "properties": {
        "effect": {
          "type": "string",
          "title": "æ•ˆæœ",
          "enum": ["Allow", "Deny"],
          "default": "Allow"
        },
        "actions": {
          "type": "array",
          "title": "æ“ä½œ",
          "items": { "type": "string" }
        },
        "resources": {
          "type": "array",
          "title": "èµ„æº",
          "items": { "type": "string" }
        },
        "principals": {
          "type": "array",
          "title": "ä¸»ä½“",
          "items": { "type": "string" }
        }
      }
    }
  }
}
```

**UIæ¸²æŸ“æ•ˆæœï¼š**
```
å­˜å‚¨æ¡¶ç­–ç•¥
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ policy-abc123                               [âœ•] â”‚ â”‚
â”‚ â”‚ æ•ˆæœ: Allow                                     â”‚ â”‚
â”‚ â”‚ æ“ä½œ: [s3:GetObject] [s3:PutObject]            â”‚ â”‚
â”‚ â”‚ èµ„æº: [arn:aws:s3:::my-bucket/*]               â”‚ â”‚
â”‚ â”‚ ä¸»ä½“: [*]                                       â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ policy-xyz789                               [âœ•] â”‚ â”‚
â”‚ â”‚ æ•ˆæœ: Deny                                      â”‚ â”‚
â”‚ â”‚ æ“ä½œ: [s3:DeleteObject]                        â”‚ â”‚
â”‚ â”‚ èµ„æº: [arn:aws:s3:::my-bucket/protected/*]     â”‚ â”‚
â”‚ â”‚ ä¸»ä½“: [*]                                       â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                     â”‚
â”‚ [+ æ·»åŠ ç­–ç•¥]  (è‡ªåŠ¨ç”ŸæˆKey: policy-xxxxxx)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Keyç”Ÿæˆç®—æ³•ï¼š**
```javascript
function generateDynamicKey() {
  const chars = 'abcdefghijklmnopqrstuvwxyz';
  const length = Math.floor(Math.random() * 8) + 8; // 8-15ä½
  let key = '';
  for (let i = 0; i < length; i++) {
    if (i > 0 && Math.random() < 0.2) {
      key += '-';
    } else {
      key += chars[Math.floor(Math.random() * chars.length)];
    }
  }
  return key;
}
```

### 6.3 ValueType ä¸ OpenAPI æ˜ å°„æ€»ç»“è¡¨

| ValueType | æšä¸¾å€¼ | OpenAPI Type | Format/Extension | é»˜è®¤Widget | æ•°æ®æºæ”¯æŒ |
|-----------|--------|--------------|------------------|------------|------------|
| TypeInvalid | 0 | - | - | - | - |
| TypeBool | 1 | `boolean` | - | `switch` | âŒ |
| TypeInt | 2 | `integer` | `int64` | `number` | âŒ |
| TypeFloat | 3 | `number` | `double` | `number` | âŒ |
| TypeString | 4 | `string` | - | `text` / `select` | âœ… |
| TypeList | 5 | `array` | `items.type: string` | `tags` / `multi-select` | âœ… |
| TypeMap | 6 | `object` | `additionalProperties` | `key-value` | âŒ |
| TypeSet | 7 | `array` | `uniqueItems: true` | `tags` / `multi-select` | âœ… |
| TypeObject | 8 | `object` | `properties` | `object` | âŒ |
| TypeJsonString | 9 | `string` | `format: json` | `json-editor` | âŒ |
| TypeText | 10 | `string` | `x-widget: textarea` | `textarea` | âŒ |
| TypeListObject | 11 | `array` | `items.type: object` | `object-list` | âŒ |
| CustomObject | 12 | `object` | `x-dynamic-keys: true` | `dynamic-object` | âŒ |

### 6.4 Terraformç±»å‹åˆ°JSON Schemaæ˜ å°„

| Terraformç±»å‹ | JSON Schemaç±»å‹ | UI Widget |
|---------------|-----------------|-----------|
| `string` | `string` | `text` |
| `number` | `number` | `number` |
| `bool` | `boolean` | `switch` |
| `list(string)` | `array` + `items.type: string` | `tags` |
| `list(object)` | `array` + `items.type: object` | `object-list` |
| `set(string)` | `array` + `items.type: string` | `tags` |
| `map(string)` | `object` + `additionalProperties` | `key-value` |
| `object({...})` | `object` + `properties` | `object` |

## 7. UIé…ç½®è§„èŒƒ

### 7.1 Widgetç±»å‹å®šä¹‰

Widget æ˜¯å‰ç«¯æ¸²æŸ“çš„æ ¸å¿ƒç»„ä»¶ï¼Œæ¯ç§ Widget å¯¹åº”ç‰¹å®šçš„æ•°æ®ç±»å‹å’Œäº¤äº’æ–¹å¼ã€‚

```typescript
type WidgetType = 
  | 'text'           // å•è¡Œæ–‡æœ¬
  | 'textarea'       // å¤šè¡Œæ–‡æœ¬
  | 'number'         // æ•°å­—è¾“å…¥
  | 'select'         // ä¸‹æ‹‰é€‰æ‹©
  | 'multi-select'   // å¤šé€‰
  | 'switch'         // å¼€å…³
  | 'tags'           // æ ‡ç­¾è¾“å…¥ï¼ˆlist(string)ï¼‰
  | 'key-value'      // é”®å€¼å¯¹ç¼–è¾‘å™¨ï¼ˆmapï¼‰
  | 'object'         // å¯¹è±¡ç¼–è¾‘å™¨
  | 'object-list'    // å¯¹è±¡åˆ—è¡¨ç¼–è¾‘å™¨
  | 'dynamic-object' // åŠ¨æ€é”®å¯¹è±¡ç¼–è¾‘å™¨
  | 'json-editor'    // JSONç¼–è¾‘å™¨
  | 'password'       // å¯†ç è¾“å…¥ï¼ˆsensitiveå­—æ®µï¼‰
  | 'datetime'       // æ—¥æœŸæ—¶é—´é€‰æ‹©å™¨
  | 'code-editor'    // ä»£ç ç¼–è¾‘å™¨ï¼ˆæ”¯æŒè¯­æ³•é«˜äº®ï¼‰
  | 'file-upload'    // æ–‡ä»¶ä¸Šä¼ 
  | 'color-picker'   // é¢œè‰²é€‰æ‹©å™¨
  | 'slider'         // æ»‘å—
  | 'radio'          // å•é€‰æŒ‰é’®ç»„
  | 'checkbox'       // å¤é€‰æ¡†
  | 'reference'      // æ¨¡å—å¼•ç”¨é€‰æ‹©å™¨ï¼ˆManifestä¸“ç”¨ï¼‰
```

### 7.2 Widget è¯¦ç»†è¯´æ˜

#### 7.2.1 text - å•è¡Œæ–‡æœ¬è¾“å…¥

| å±æ€§ | è¯´æ˜ |
|------|------|
| **å¯¹åº”ValueType** | TypeString (4) |
| **æ•°æ®ç±»å‹** | `string` |
| **å®ç°çŠ¶æ€** | âœ… å·²å®ç° |
| **å…¸å‹åœºæ™¯** | åç§°ã€IDã€ç®€çŸ­æè¿° |

**æ”¯æŒçš„å±æ€§ï¼š**
- `placeholder`: å ä½ç¬¦æ–‡æœ¬
- `maxLength`: æœ€å¤§é•¿åº¦
- `minLength`: æœ€å°é•¿åº¦
- `pattern`: æ­£åˆ™è¡¨è¾¾å¼éªŒè¯
- `prefix`: å‰ç¼€æ–‡æœ¬
- `suffix`: åç¼€æ–‡æœ¬

```json
{
  "name": {
    "type": "string",
    "title": "å®ä¾‹åç§°",
    "maxLength": 64,
    "pattern": "^[a-z][a-z0-9-]*$"
  }
}
```

**UIé…ç½®ï¼š**
```json
{
  "x-iac-platform": {
    "ui": {
      "fields": {
        "name": {
          "widget": "text",
          "placeholder": "è¾“å…¥å®ä¾‹åç§°",
          "help": "åªèƒ½åŒ…å«å°å†™å­—æ¯ã€æ•°å­—å’Œä¸­æ¨ªçº¿"
        }
      }
    }
  }
}
```

---

#### 7.2.2 textarea - å¤šè¡Œæ–‡æœ¬è¾“å…¥

| å±æ€§ | è¯´æ˜ |
|------|------|
| **å¯¹åº”ValueType** | TypeText (10) |
| **æ•°æ®ç±»å‹** | `string` |
| **å®ç°çŠ¶æ€** | âœ… å·²å®ç° |
| **å…¸å‹åœºæ™¯** | User Dataã€å¯åŠ¨è„šæœ¬ã€é…ç½®æ–‡ä»¶å†…å®¹ |

**æ”¯æŒçš„å±æ€§ï¼š**
- `rows`: æ˜¾ç¤ºè¡Œæ•°ï¼ˆé»˜è®¤4ï¼‰
- `maxLength`: æœ€å¤§é•¿åº¦
- `autoResize`: æ˜¯å¦è‡ªåŠ¨è°ƒæ•´é«˜åº¦

**ç‰¹æ®ŠåŠŸèƒ½ï¼š**
- æ”¯æŒæ•°ç»„ç±»å‹è¾“å…¥ï¼ˆæ¯è¡Œä¸€ä¸ªå…ƒç´ ï¼Œè‡ªåŠ¨è½¬æ¢ä¸ºæ•°ç»„ï¼‰

```json
{
  "user_data": {
    "type": "string",
    "title": "User Data",
    "x-widget": "textarea"
  }
}
```

---

#### 7.2.3 number - æ•°å­—è¾“å…¥

| å±æ€§ | è¯´æ˜ |
|------|------|
| **å¯¹åº”ValueType** | TypeInt (2), TypeFloat (3) |
| **æ•°æ®ç±»å‹** | `integer` / `number` |
| **å®ç°çŠ¶æ€** | âœ… å·²å®ç° |
| **å…¸å‹åœºæ™¯** | ç£ç›˜å®¹é‡ã€ç«¯å£å·ã€å®ä¾‹æ•°é‡ |

**æ”¯æŒçš„å±æ€§ï¼š**
- `minimum`: æœ€å°å€¼
- `maximum`: æœ€å¤§å€¼
- `step`: æ­¥è¿›å€¼ï¼ˆé»˜è®¤1ï¼‰
- `unit`: å•ä½æ˜¾ç¤ºï¼ˆå¦‚ GBã€MBï¼‰

```json
{
  "volume_size": {
    "type": "integer",
    "title": "ç£ç›˜å®¹é‡",
    "minimum": 8,
    "maximum": 16384,
    "default": 20
  }
}
```

**UIé…ç½®ï¼š**
```json
{
  "x-iac-platform": {
    "ui": {
      "fields": {
        "volume_size": {
          "widget": "number",
          "unit": "GB",
          "step": 1
        }
      }
    }
  }
}
```

---

#### 7.2.4 select - ä¸‹æ‹‰é€‰æ‹©

| å±æ€§ | è¯´æ˜ |
|------|------|
| **å¯¹åº”ValueType** | TypeString (4) |
| **æ•°æ®ç±»å‹** | `string` (å¸¦ `enum`) |
| **å®ç°çŠ¶æ€** | âœ… å·²å®ç° |
| **å…¸å‹åœºæ™¯** | å®ä¾‹ç±»å‹ã€å·ç±»å‹ã€åŒºåŸŸé€‰æ‹© |

**æ”¯æŒçš„å±æ€§ï¼š**
- `enum`: é™æ€é€‰é¡¹åˆ—è¡¨
- `source`: å¤–éƒ¨æ•°æ®æºID
- `searchable`: æ˜¯å¦æ”¯æŒæœç´¢
- `allowCustom`: æ˜¯å¦å…è®¸è‡ªå®šä¹‰è¾“å…¥
- `groupBy`: åˆ†ç»„å­—æ®µ
- `allowEmpty`: æ˜¯å¦å…è®¸ç©ºå€¼
- `emptyLabel`: ç©ºå€¼æ˜¾ç¤ºæ–‡æœ¬

```json
{
  "volume_type": {
    "type": "string",
    "title": "å·ç±»å‹",
    "enum": ["gp2", "gp3", "io1", "io2"],
    "default": "gp3"
  }
}
```

**å¸¦æ•°æ®æºçš„é…ç½®ï¼š**
```json
{
  "x-iac-platform": {
    "ui": {
      "fields": {
        "ami": {
          "widget": "select",
          "source": "ami_list",
          "searchable": true,
          "allowCustom": true,
          "customPlaceholder": "æˆ–è¾“å…¥è‡ªå®šä¹‰AMI ID"
        }
      }
    }
  }
}
```

---

#### 7.2.5 multi-select - å¤šé€‰ä¸‹æ‹‰

| å±æ€§ | è¯´æ˜ |
|------|------|
| **å¯¹åº”ValueType** | TypeList (5), TypeSet (7) |
| **æ•°æ®ç±»å‹** | `array` |
| **å®ç°çŠ¶æ€** | âœ… å·²å®ç°ï¼ˆå¤ç”¨SelectWidgetï¼‰ |
| **å…¸å‹åœºæ™¯** | å®‰å…¨ç»„é€‰æ‹©ã€å­ç½‘é€‰æ‹© |

**æ”¯æŒçš„å±æ€§ï¼š**
- ç»§æ‰¿ `select` çš„æ‰€æœ‰å±æ€§
- `maxItems`: æœ€å¤§é€‰æ‹©æ•°é‡
- `minItems`: æœ€å°é€‰æ‹©æ•°é‡

```json
{
  "vpc_security_group_ids": {
    "type": "array",
    "items": { "type": "string" },
    "title": "å®‰å…¨ç»„"
  }
}
```

---

#### 7.2.6 switch - å¼€å…³

| å±æ€§ | è¯´æ˜ |
|------|------|
| **å¯¹åº”ValueType** | TypeBool (1) |
| **æ•°æ®ç±»å‹** | `boolean` |
| **å®ç°çŠ¶æ€** | âœ… å·²å®ç° |
| **å…¸å‹åœºæ™¯** | å¯ç”¨/ç¦ç”¨åŠŸèƒ½å¼€å…³ |

**æ”¯æŒçš„å±æ€§ï¼š**
- `checkedLabel`: å¼€å¯æ—¶æ˜¾ç¤ºçš„æ–‡æœ¬
- `uncheckedLabel`: å…³é—­æ—¶æ˜¾ç¤ºçš„æ–‡æœ¬

```json
{
  "enable_versioning": {
    "type": "boolean",
    "title": "å¯ç”¨ç‰ˆæœ¬æ§åˆ¶",
    "default": false
  }
}
```

---

#### 7.2.7 tags - æ ‡ç­¾è¾“å…¥

| å±æ€§ | è¯´æ˜ |
|------|------|
| **å¯¹åº”ValueType** | TypeList (5), TypeSet (7) |
| **æ•°æ®ç±»å‹** | `array` (items: string) |
| **å®ç°çŠ¶æ€** | âœ… å·²å®ç° |
| **å…¸å‹åœºæ™¯** | å¯ç”¨åŒºåˆ—è¡¨ã€IPåœ°å€åˆ—è¡¨ |

**æ”¯æŒçš„å±æ€§ï¼š**
- `maxTags`: æœ€å¤§æ ‡ç­¾æ•°é‡
- `allowDuplicates`: æ˜¯å¦å…è®¸é‡å¤ï¼ˆSetç±»å‹ä¸ºfalseï¼‰
- `separator`: åˆ†éš”ç¬¦ï¼ˆé»˜è®¤å›è½¦ï¼‰
- `source`: å¤–éƒ¨æ•°æ®æºï¼ˆæä¾›å»ºè®®ï¼‰

```json
{
  "availability_zones": {
    "type": "array",
    "items": { "type": "string" },
    "title": "å¯ç”¨åŒº"
  }
}
```

---

#### 7.2.8 key-value - é”®å€¼å¯¹ç¼–è¾‘å™¨

| å±æ€§ | è¯´æ˜ |
|------|------|
| **å¯¹åº”ValueType** | TypeMap (6) |
| **æ•°æ®ç±»å‹** | `object` (additionalProperties) |
| **å®ç°çŠ¶æ€** | âœ… å·²å®ç° |
| **å…¸å‹åœºæ™¯** | èµ„æºæ ‡ç­¾ã€ç¯å¢ƒå˜é‡ |

**æ”¯æŒçš„å±æ€§ï¼š**
- `keyPlaceholder`: Keyè¾“å…¥æ¡†å ä½ç¬¦
- `valuePlaceholder`: Valueè¾“å…¥æ¡†å ä½ç¬¦
- `keyPattern`: Keyçš„æ­£åˆ™éªŒè¯
- `valueType`: Valueçš„ç±»å‹ï¼ˆé»˜è®¤stringï¼‰
- `maxItems`: æœ€å¤§é”®å€¼å¯¹æ•°é‡

```json
{
  "tags": {
    "type": "object",
    "title": "èµ„æºæ ‡ç­¾",
    "additionalProperties": { "type": "string" }
  }
}
```

---

#### 7.2.9 object - å¯¹è±¡ç¼–è¾‘å™¨

| å±æ€§ | è¯´æ˜ |
|------|------|
| **å¯¹åº”ValueType** | TypeObject (8) |
| **æ•°æ®ç±»å‹** | `object` (properties) |
| **å®ç°çŠ¶æ€** | âš ï¸ æš‚æ—¶å¤ç”¨KeyValueWidget |
| **å…¸å‹åœºæ™¯** | æ ¹å·é…ç½®ã€ç½‘ç»œæ¥å£é…ç½® |

**ç‰¹ç‚¹ï¼š**
- Keyç”±Schemaå®šä¹‰ï¼Œç”¨æˆ·ä¸å¯ä¿®æ”¹
- Valueå¯ä»¥æ˜¯ä»»æ„ç±»å‹
- é€’å½’æ¸²æŸ“åµŒå¥—å±æ€§

```json
{
  "root_block_device": {
    "type": "object",
    "title": "æ ¹å·é…ç½®",
    "properties": {
      "volume_size": { "type": "integer" },
      "volume_type": { "type": "string", "enum": ["gp2", "gp3"] },
      "encrypted": { "type": "boolean" }
    }
  }
}
```

**TODOï¼š** éœ€è¦å®ç°ä¸“é—¨çš„ ObjectWidget ç»„ä»¶ï¼Œæ”¯æŒï¼š
- åµŒå¥—å±æ€§çš„é€’å½’æ¸²æŸ“
- æŠ˜å /å±•å¼€åŠŸèƒ½
- å±æ€§çº§åˆ«çš„éªŒè¯

---

#### 7.2.10 object-list - å¯¹è±¡åˆ—è¡¨ç¼–è¾‘å™¨

| å±æ€§ | è¯´æ˜ |
|------|------|
| **å¯¹åº”ValueType** | TypeListObject (11) |
| **æ•°æ®ç±»å‹** | `array` (items: object) |
| **å®ç°çŠ¶æ€** | âš ï¸ æš‚æ—¶å¤ç”¨KeyValueWidget |
| **å…¸å‹åœºæ™¯** | EBSå·é…ç½®åˆ—è¡¨ã€å…¥ç«™è§„åˆ™åˆ—è¡¨ |

**æ”¯æŒçš„å±æ€§ï¼š**
- `minItems`: æœ€å°é¡¹ç›®æ•°
- `maxItems`: æœ€å¤§é¡¹ç›®æ•°
- `sortable`: æ˜¯å¦æ”¯æŒæ‹–æ‹½æ’åº
- `collapsible`: æ˜¯å¦æ”¯æŒæŠ˜å 

```json
{
  "ebs_block_device": {
    "type": "array",
    "title": "EBSå·é…ç½®",
    "items": {
      "type": "object",
      "properties": {
        "device_name": { "type": "string" },
        "volume_size": { "type": "integer" }
      }
    }
  }
}
```

**TODOï¼š** éœ€è¦å®ç°ä¸“é—¨çš„ ObjectListWidget ç»„ä»¶ï¼Œæ”¯æŒï¼š
- æ·»åŠ /åˆ é™¤/å¤åˆ¶é¡¹ç›®
- æ‹–æ‹½æ’åº
- é¡¹ç›®æŠ˜å /å±•å¼€
- æ‰¹é‡æ“ä½œ

---

#### 7.2.11 dynamic-object - åŠ¨æ€é”®å¯¹è±¡ç¼–è¾‘å™¨

| å±æ€§ | è¯´æ˜ |
|------|------|
| **å¯¹åº”ValueType** | CustomObject (12) |
| **æ•°æ®ç±»å‹** | `object` (x-dynamic-keys: true) |
| **å®ç°çŠ¶æ€** | âŒ æœªå®ç° |
| **å…¸å‹åœºæ™¯** | å¤šä¸ªå‘½åèµ„æºé…ç½® |

**ç‰¹ç‚¹ï¼š**
- Keyç”±å‰ç«¯è‡ªåŠ¨ç”Ÿæˆï¼ˆ8-15ä½å°å†™å­—æ¯+ä¸­æ¨ªçº¿ï¼‰
- Valueä¸ºå›ºå®šçš„TypeObjectç»“æ„
- æ”¯æŒæ·»åŠ /åˆ é™¤é¡¹ç›®

```json
{
  "bucket_policies": {
    "type": "object",
    "title": "å­˜å‚¨æ¡¶ç­–ç•¥",
    "x-dynamic-keys": true,
    "x-key-pattern": "^[a-z][a-z0-9-]{7,14}$",
    "additionalProperties": {
      "type": "object",
      "properties": { ... }
    }
  }
}
```

**TODOï¼š** éœ€è¦å®ç° DynamicObjectWidget ç»„ä»¶ï¼Œæ”¯æŒï¼š
- è‡ªåŠ¨ç”Ÿæˆç¬¦åˆè§„åˆ™çš„Key
- Keyçš„å”¯ä¸€æ€§æ£€æŸ¥
- é¡¹ç›®çš„æ·»åŠ /åˆ é™¤
- åµŒå¥—Objectçš„æ¸²æŸ“

---

#### 7.2.12 json-editor - JSONç¼–è¾‘å™¨

| å±æ€§ | è¯´æ˜ |
|------|------|
| **å¯¹åº”ValueType** | TypeJsonString (9) |
| **æ•°æ®ç±»å‹** | `string` (format: json) |
| **å®ç°çŠ¶æ€** | âš ï¸ æš‚æ—¶å¤ç”¨TextWidget |
| **å…¸å‹åœºæ™¯** | IAMç­–ç•¥æ–‡æ¡£ã€Lambdaé…ç½® |

**æ”¯æŒçš„å±æ€§ï¼š**
- `height`: ç¼–è¾‘å™¨é«˜åº¦
- `theme`: ä¸»é¢˜ï¼ˆlight/darkï¼‰
- `validateOnChange`: æ˜¯å¦å®æ—¶éªŒè¯JSONæ ¼å¼

```json
{
  "policy_document": {
    "type": "string",
    "format": "json",
    "title": "IAMç­–ç•¥æ–‡æ¡£"
  }
}
```

**TODOï¼š** éœ€è¦å®ç°ä¸“é—¨çš„ JsonEditorWidget ç»„ä»¶ï¼Œæ”¯æŒï¼š
- è¯­æ³•é«˜äº®
- è‡ªåŠ¨æ ¼å¼åŒ–
- JSON SchemaéªŒè¯
- é”™è¯¯æç¤º
- è¡Œå·æ˜¾ç¤º

---

#### 7.2.13 password - å¯†ç è¾“å…¥

| å±æ€§ | è¯´æ˜ |
|------|------|
| **å¯¹åº”ValueType** | TypeString (4) (sensitive) |
| **æ•°æ®ç±»å‹** | `string` |
| **å®ç°çŠ¶æ€** | âš ï¸ æš‚æ—¶å¤ç”¨TextWidget |
| **å…¸å‹åœºæ™¯** | æ•°æ®åº“å¯†ç ã€APIå¯†é’¥ |

**æ”¯æŒçš„å±æ€§ï¼š**
- `showToggle`: æ˜¯å¦æ˜¾ç¤ºå¯†ç å¯è§æ€§åˆ‡æ¢æŒ‰é’®
- `autoComplete`: è‡ªåŠ¨å®Œæˆå±æ€§

```json
{
  "db_password": {
    "type": "string",
    "title": "æ•°æ®åº“å¯†ç ",
    "x-sensitive": true
  }
}
```

**TODOï¼š** éœ€è¦å®ç°ä¸“é—¨çš„ PasswordWidget ç»„ä»¶ï¼Œæ”¯æŒï¼š
- å¯†ç å¯è§æ€§åˆ‡æ¢
- å¯†ç å¼ºåº¦æŒ‡ç¤ºå™¨
- è‡ªåŠ¨ç”Ÿæˆå¯†ç åŠŸèƒ½

---

#### 7.2.14 datetime - æ—¥æœŸæ—¶é—´é€‰æ‹©å™¨

| å±æ€§ | è¯´æ˜ |
|------|------|
| **å¯¹åº”ValueType** | TypeString (4) |
| **æ•°æ®ç±»å‹** | `string` (format: date-time) |
| **å®ç°çŠ¶æ€** | âš ï¸ æš‚æ—¶å¤ç”¨TextWidget |
| **å…¸å‹åœºæ™¯** | è®¡åˆ’ä»»åŠ¡æ—¶é—´ã€è¿‡æœŸæ—¶é—´ |

**æ”¯æŒçš„å±æ€§ï¼š**
- `format`: æ—¥æœŸæ ¼å¼ï¼ˆdate/time/datetimeï¼‰
- `minDate`: æœ€å°æ—¥æœŸ
- `maxDate`: æœ€å¤§æ—¥æœŸ
- `timezone`: æ—¶åŒº

```json
{
  "expiration_date": {
    "type": "string",
    "format": "date-time",
    "title": "è¿‡æœŸæ—¶é—´"
  }
}
```

**TODOï¼š** éœ€è¦å®ç°ä¸“é—¨çš„ DateTimeWidget ç»„ä»¶ï¼Œæ”¯æŒï¼š
- æ—¥æœŸé€‰æ‹©å™¨
- æ—¶é—´é€‰æ‹©å™¨
- æ—¶åŒºé€‰æ‹©
- ç›¸å¯¹æ—¶é—´è¾“å…¥ï¼ˆå¦‚ +7dï¼‰

---

#### 7.2.15 code-editor - ä»£ç ç¼–è¾‘å™¨

| å±æ€§ | è¯´æ˜ |
|------|------|
| **å¯¹åº”ValueType** | TypeText (10) |
| **æ•°æ®ç±»å‹** | `string` |
| **å®ç°çŠ¶æ€** | âŒ æœªå®ç° |
| **å…¸å‹åœºæ™¯** | Terraformä»£ç ã€Shellè„šæœ¬ã€YAMLé…ç½® |

**æ”¯æŒçš„å±æ€§ï¼š**
- `language`: è¯­è¨€ç±»å‹ï¼ˆhcl/yaml/json/shell/pythonç­‰ï¼‰
- `height`: ç¼–è¾‘å™¨é«˜åº¦
- `theme`: ä¸»é¢˜
- `lineNumbers`: æ˜¯å¦æ˜¾ç¤ºè¡Œå·

```json
{
  "terraform_code": {
    "type": "string",
    "title": "Terraformä»£ç ",
    "x-widget": "code-editor",
    "x-language": "hcl"
  }
}
```

**TODOï¼š** éœ€è¦å®ç° CodeEditorWidget ç»„ä»¶ï¼Œæ”¯æŒï¼š
- å¤šè¯­è¨€è¯­æ³•é«˜äº®
- ä»£ç æŠ˜å 
- è‡ªåŠ¨è¡¥å…¨
- é”™è¯¯æç¤º

---

#### 7.2.16 reference - æ¨¡å—å¼•ç”¨é€‰æ‹©å™¨

| å±æ€§ | è¯´æ˜ |
|------|------|
| **å¯¹åº”ValueType** | TypeString (4) |
| **æ•°æ®ç±»å‹** | `string` |
| **å®ç°çŠ¶æ€** | âœ… å·²å®ç°ï¼ˆåœ¨Manifestç¼–è¾‘å™¨ä¸­ï¼‰ |
| **å…¸å‹åœºæ™¯** | Manifestä¸­æ¨¡å—é—´çš„è¾“å‡ºå¼•ç”¨ |

**ç‰¹ç‚¹ï¼š**
- ä»…åœ¨Manifestç¼–è¾‘å™¨ä¸Šä¸‹æ–‡ä¸­å¯ç”¨
- æ˜¾ç¤ºå·²è¿çº¿çš„ä¸Šæ¸¸æ¨¡å—çš„è¾“å‡º
- ç”Ÿæˆ `${module.xxx.output_name}` æ ¼å¼çš„å¼•ç”¨

```json
{
  "vpc_id": {
    "type": "string",
    "title": "VPC ID",
    "x-widget": "reference",
    "x-reference-type": "module-output"
  }
}
```

---

### 7.3 Widget å®ç°çŠ¶æ€æ€»ç»“

| Widget | å®ç°çŠ¶æ€ | è¯´æ˜ |
|--------|----------|------|
| `text` | âœ… å·²å®ç° | å®Œæ•´åŠŸèƒ½ï¼Œæ”¯æŒæ¨¡å—å¼•ç”¨ |
| `textarea` | âœ… å·²å®ç° | æ”¯æŒæ•°ç»„è½¬æ¢ï¼Œæ”¯æŒæ¨¡å—å¼•ç”¨ |
| `number` | âœ… å·²å®ç° | å®Œæ•´åŠŸèƒ½ï¼Œæ”¯æŒæ¨¡å—å¼•ç”¨ |
| `select` | âœ… å·²å®ç° | æ”¯æŒæ•°æ®æºï¼Œæ”¯æŒæ¨¡å—å¼•ç”¨ |
| `multi-select` | âœ… å·²å®ç° | å¤ç”¨SelectWidget |
| `switch` | âœ… å·²å®ç° | å®Œæ•´åŠŸèƒ½ |
| `tags` | âœ… å·²å®ç° | å®Œæ•´åŠŸèƒ½ï¼Œæ”¯æŒæ¨¡å—å¼•ç”¨ |
| `key-value` | âœ… å·²å®ç° | å®Œæ•´åŠŸèƒ½ï¼Œæ”¯æŒæ¨¡å—å¼•ç”¨ |
| `object` | âœ… å·²å®ç° | æ”¯æŒåµŒå¥—å±æ€§é€’å½’æ¸²æŸ“ |
| `object-list` | âœ… å·²å®ç° | æ”¯æŒæ·»åŠ /åˆ é™¤/å¤åˆ¶é¡¹ç›® |
| `dynamic-object` | âœ… å·²å®ç° | åŠ¨æ€é”®å¯¹è±¡ç¼–è¾‘å™¨ï¼Œè‡ªåŠ¨ç”ŸæˆKey |
| `json-editor` | âœ… å·²å®ç° | æ”¯æŒæ ¼å¼åŒ–å’ŒéªŒè¯ |
| `password` | âœ… å·²å®ç° | å¯†ç å¯è§æ€§åˆ‡æ¢ã€å¼ºåº¦æŒ‡ç¤ºå™¨ |
| `datetime` | âœ… å·²å®ç° | æ—¥æœŸ/æ—¶é—´/æ—¥æœŸæ—¶é—´é€‰æ‹©å™¨ |
| `code-editor` | âœ… å·²å®ç° | å¤šè¯­è¨€æ”¯æŒã€è¡Œå·æ˜¾ç¤ºã€å¤åˆ¶åŠŸèƒ½ |
| `file-upload` | âŒ æœªå®ç° | éœ€è¦æ–°å¼€å‘ |
| `color-picker` | âŒ æœªå®ç° | ä½ä¼˜å…ˆçº§ |
| `slider` | âŒ æœªå®ç° | ä½ä¼˜å…ˆçº§ |
| `radio` | âŒ æœªå®ç° | å¯ç”¨selectæ›¿ä»£ |
| `checkbox` | âŒ æœªå®ç° | å¯ç”¨switchæ›¿ä»£ |
| `reference` | âœ… å·²å®ç° | Manifestä¸“ç”¨ |

### 7.4 Widget å¼€å‘ä¼˜å…ˆçº§ TODO

#### é«˜ä¼˜å…ˆçº§ï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰

1. **ObjectWidget** - å¯¹è±¡ç¼–è¾‘å™¨
   - æ”¯æŒåµŒå¥—å±æ€§é€’å½’æ¸²æŸ“
   - æŠ˜å /å±•å¼€åŠŸèƒ½
   - å±æ€§çº§åˆ«éªŒè¯
   - é¢„è®¡å·¥ä½œé‡ï¼š3å¤©

2. **ObjectListWidget** - å¯¹è±¡åˆ—è¡¨ç¼–è¾‘å™¨
   - æ·»åŠ /åˆ é™¤/å¤åˆ¶é¡¹ç›®
   - æ‹–æ‹½æ’åº
   - é¡¹ç›®æŠ˜å /å±•å¼€
   - é¢„è®¡å·¥ä½œé‡ï¼š3å¤©

3. **JsonEditorWidget** - JSONç¼–è¾‘å™¨
   - é›†æˆMonaco Editoræˆ–CodeMirror
   - è¯­æ³•é«˜äº®å’Œæ ¼å¼åŒ–
   - JSON SchemaéªŒè¯
   - é¢„è®¡å·¥ä½œé‡ï¼š2å¤©

4. **DynamicObjectWidget** - åŠ¨æ€é”®å¯¹è±¡ç¼–è¾‘å™¨
   - è‡ªåŠ¨ç”ŸæˆKey
   - å”¯ä¸€æ€§æ£€æŸ¥
   - åµŒå¥—Objectæ¸²æŸ“
   - é¢„è®¡å·¥ä½œé‡ï¼š2å¤©

#### ä¸­ä¼˜å…ˆçº§ï¼ˆå¢å¼ºä½“éªŒï¼‰

5. **PasswordWidget** - å¯†ç è¾“å…¥
   - å¯è§æ€§åˆ‡æ¢
   - å¼ºåº¦æŒ‡ç¤ºå™¨
   - é¢„è®¡å·¥ä½œé‡ï¼š1å¤©

6. **DateTimeWidget** - æ—¥æœŸæ—¶é—´é€‰æ‹©å™¨
   - æ—¥æœŸ/æ—¶é—´é€‰æ‹©
   - æ—¶åŒºæ”¯æŒ
   - é¢„è®¡å·¥ä½œé‡ï¼š1å¤©

7. **CodeEditorWidget** - ä»£ç ç¼–è¾‘å™¨
   - å¤šè¯­è¨€æ”¯æŒ
   - è¯­æ³•é«˜äº®
   - é¢„è®¡å·¥ä½œé‡ï¼š2å¤©

#### ä½ä¼˜å…ˆçº§ï¼ˆå¯é€‰åŠŸèƒ½ï¼‰

8. **FileUploadWidget** - æ–‡ä»¶ä¸Šä¼ 
9. **SliderWidget** - æ»‘å—
10. **ColorPickerWidget** - é¢œè‰²é€‰æ‹©å™¨
11. **RadioWidget** - å•é€‰æŒ‰é’®ç»„
12. **CheckboxWidget** - å¤é€‰æ¡†

### 7.5 Widget ä¸ ValueType æ˜ å°„å…³ç³»

| ValueType | é»˜è®¤Widget | å¯é€‰Widget |
|-----------|------------|------------|
| TypeBool (1) | `switch` | `checkbox` |
| TypeInt (2) | `number` | `slider`, `select` |
| TypeFloat (3) | `number` | `slider` |
| TypeString (4) | `text` | `select`, `textarea`, `password`, `datetime`, `reference` |
| TypeList (5) | `tags` | `multi-select`, `textarea` |
| TypeMap (6) | `key-value` | - |
| TypeSet (7) | `tags` | `multi-select` |
| TypeObject (8) | `object` | - |
| TypeJsonString (9) | `json-editor` | `textarea`, `code-editor` |
| TypeText (10) | `textarea` | `code-editor` |
| TypeListObject (11) | `object-list` | - |
| CustomObject (12) | `dynamic-object` | - |

### 7.2 å­—æ®µUIé…ç½®

```json
{
  "x-iac-platform": {
    "ui": {
      "fields": {
        "name": {
          "widget": "text",
          "label": "å®ä¾‹åç§°",
          "group": "basic",
          "order": 1,
          "placeholder": "è¾“å…¥å®ä¾‹åç§°",
          "help": "å®ä¾‹åç§°å°†ç”¨äºæ ‡è¯†èµ„æº",
          "hiddenByDefault": false
        },
        "tags": {
          "widget": "key-value",
          "label": "æ ‡ç­¾",
          "group": "basic",
          "order": 10,
          "help": "èµ„æºæ ‡ç­¾"
        },
        "vpc_security_group_ids": {
          "widget": "tags",
          "label": "å®‰å…¨ç»„",
          "group": "basic",
          "order": 8,
          "help": "å…³è”çš„å®‰å…¨ç»„IDåˆ—è¡¨"
        }
      }
    }
  }
}
```

### 7.3 åˆ†ç»„é…ç½®

```json
{
  "x-iac-platform": {
    "ui": {
      "groups": [
        {
          "id": "basic",
          "title": "åŸºç¡€é…ç½®",
          "icon": "settings",
          "order": 1,
          "defaultExpanded": true
        },
        {
          "id": "advanced",
          "title": "é«˜çº§é…ç½®",
          "icon": "code",
          "order": 2,
          "defaultExpanded": false,
          "hiddenByDefault": true
        }
      ],
      "layout": {
        "type": "tabs",
        "position": "top"
      }
    }
  }
}
```

## 8. éªŒè¯è§„åˆ™è§„èŒƒ

### 8.1 Terraform Validationè½¬æ¢

Terraformçš„validationå—ä¼šè¢«è‡ªåŠ¨è½¬æ¢ä¸ºJSON Schemaçš„patternå’Œx-validationï¼š

```hcl
# Terraform
variable "ami" {
  type = string
  validation {
    condition     = var.ami == null || can(regex("^ami-", var.ami))
    error_message = "AMI ID must start with 'ami-'."
  }
}
```

```json
// ç”Ÿæˆçš„JSON Schema
{
  "ami": {
    "type": "string",
    "pattern": "^ami-",
    "x-validation": [
      {
        "condition": "var.ami == null || can(regex(\"^ami-\", var.ami))",
        "errorMessage": "AMI ID must start with 'ami-'.",
        "pattern": "^ami-"
      }
    ]
  }
}
```

### 8.2 è·¨å­—æ®µéªŒè¯è§„åˆ™

```json
{
  "x-iac-platform": {
    "validation": {
      "rules": [
        {
          "id": "ami-conflict",
          "type": "conflicts",
          "fields": ["ami", "ami_ssm_parameter"],
          "message": "amiå’Œami_ssm_parameterä¸èƒ½åŒæ—¶è®¾ç½®"
        },
        {
          "id": "encryption-key-required",
          "type": "requiredWith",
          "trigger": {
            "field": "sse_algorithm",
            "value": "aws:kms"
          },
          "requires": ["kms_key_id"],
          "message": "ä½¿ç”¨KMSåŠ å¯†æ—¶å¿…é¡»æŒ‡å®šKMSå¯†é’¥"
        }
      ]
    }
  }
}
```

## 9. å¤–éƒ¨æ•°æ®æºè§„èŒƒ

### 9.1 æ•°æ®æºå®šä¹‰

å¤–éƒ¨æ•°æ®æºç”¨äºä»APIåŠ¨æ€è·å–é€‰é¡¹æ•°æ®ï¼Œå¦‚AMIåˆ—è¡¨ã€KMSå¯†é’¥ã€VPCã€å­ç½‘ç­‰ã€‚

```json
{
  "x-iac-platform": {
    "external": {
      "sources": [
        {
          "id": "ami_list",
          "type": "api",
          "api": "/api/v1/aws/ec2/images",
          "method": "GET",
          "params": {
            "region": "${providers.aws.region}",
            "owners": "amazon",
            "filters": "name=amzn2-ami-hvm-*-x86_64-gp2"
          },
          "cache": {
            "ttl": 300,
            "key": "ami_list_${providers.aws.region}"
          },
          "transform": {
            "type": "jmespath",
            "expression": "data.images[*].{value: image_id, label: name, description: description}"
          }
        },
        {
          "id": "kms_keys",
          "type": "api",
          "api": "/api/v1/aws/kms/keys",
          "method": "GET",
          "params": {
            "region": "${providers.aws.region}"
          },
          "cache": {
            "ttl": 300
          },
          "transform": {
            "type": "jmespath",
            "expression": "data.keys[*].{value: arn, label: alias}"
          }
        },
        {
          "id": "vpc_list",
          "type": "api",
          "api": "/api/v1/aws/ec2/vpcs",
          "method": "GET",
          "params": {
            "region": "${providers.aws.region}"
          },
          "cache": {
            "ttl": 300
          },
          "transform": {
            "type": "jmespath",
            "expression": "data.vpcs[*].{value: vpc_id, label: tags.Name || vpc_id}"
          }
        },
        {
          "id": "subnet_list",
          "type": "api",
          "api": "/api/v1/aws/ec2/subnets",
          "method": "GET",
          "params": {
            "region": "${providers.aws.region}",
            "vpc_id": "${fields.vpc_id}"
          },
          "cache": {
            "ttl": 300
          },
          "transform": {
            "type": "jmespath",
            "expression": "data.subnets[*].{value: subnet_id, label: tags.Name || subnet_id, group: availability_zone}"
          },
          "dependsOn": ["vpc_id"]
        },
        {
          "id": "security_groups",
          "type": "api",
          "api": "/api/v1/aws/ec2/security-groups",
          "method": "GET",
          "params": {
            "region": "${providers.aws.region}",
            "vpc_id": "${fields.vpc_id}"
          },
          "cache": {
            "ttl": 300
          },
          "transform": {
            "type": "jmespath",
            "expression": "data.security_groups[*].{value: group_id, label: group_name, description: description}"
          },
          "dependsOn": ["vpc_id"]
        },
        {
          "id": "instance_types",
          "type": "api",
          "api": "/api/v1/aws/ec2/instance-types",
          "method": "GET",
          "params": {
            "region": "${providers.aws.region}"
          },
          "cache": {
            "ttl": 3600
          },
          "transform": {
            "type": "jmespath",
            "expression": "data.instance_types[*].{value: instance_type, label: instance_type, vcpu: vcpu_info.default_vcpus, memory: memory_info.size_in_mib}"
          }
        }
      ]
    }
  }
}
```

### 9.2 æ•°æ®æºå±æ€§è¯´æ˜

| å±æ€§ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `id` | string | æ˜¯ | æ•°æ®æºå”¯ä¸€æ ‡è¯† |
| `type` | string | æ˜¯ | æ•°æ®æºç±»å‹ï¼š`api`ã€`static`ã€`terraform` |
| `api` | string | æ˜¯ | APIç«¯ç‚¹è·¯å¾„ |
| `method` | string | å¦ | HTTPæ–¹æ³•ï¼Œé»˜è®¤GET |
| `params` | object | å¦ | è¯·æ±‚å‚æ•°ï¼Œæ”¯æŒå˜é‡æ›¿æ¢ |
| `cache` | object | å¦ | ç¼“å­˜é…ç½® |
| `cache.ttl` | number | å¦ | ç¼“å­˜æ—¶é—´ï¼ˆç§’ï¼‰ |
| `cache.key` | string | å¦ | ç¼“å­˜é”®ï¼Œæ”¯æŒå˜é‡æ›¿æ¢ |
| `transform` | object | å¦ | æ•°æ®è½¬æ¢é…ç½® |
| `transform.type` | string | å¦ | è½¬æ¢ç±»å‹ï¼š`jmespath`ã€`jsonpath` |
| `transform.expression` | string | å¦ | è½¬æ¢è¡¨è¾¾å¼ |
| `dependsOn` | array | å¦ | ä¾èµ–çš„å­—æ®µï¼Œå­—æ®µå˜åŒ–æ—¶é‡æ–°åŠ è½½ |

### 9.3 å˜é‡æ›¿æ¢è¯­æ³•

| è¯­æ³• | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `${providers.aws.region}` | Provideré…ç½® | `us-east-1` |
| `${fields.vpc_id}` | è¡¨å•å­—æ®µå€¼ | `vpc-12345678` |
| `${workspace.id}` | Workspace ID | `ws-abc123` |
| `${organization.id}` | Organization ID | `org-xyz789` |

### 9.4 å­—æ®µç»‘å®šæ•°æ®æº

åœ¨UIé…ç½®ä¸­å°†å­—æ®µç»‘å®šåˆ°æ•°æ®æºï¼š

```json
{
  "x-iac-platform": {
    "ui": {
      "fields": {
        "ami": {
          "widget": "select",
          "label": "AMI",
          "group": "basic",
          "order": 2,
          "help": "é€‰æ‹©EC2å®ä¾‹ä½¿ç”¨çš„AMIé•œåƒ",
          "source": "ami_list",
          "searchable": true,
          "allowCustom": true,
          "customPlaceholder": "æˆ–è¾“å…¥è‡ªå®šä¹‰AMI ID (ami-xxx)"
        },
        "instance_type": {
          "widget": "select",
          "label": "å®ä¾‹ç±»å‹",
          "group": "basic",
          "order": 3,
          "source": "instance_types",
          "searchable": true,
          "groupBy": "family",
          "renderOption": {
            "template": "${label} (${vcpu} vCPU, ${memory} MB)"
          }
        },
        "subnet_id": {
          "widget": "select",
          "label": "å­ç½‘",
          "group": "basic",
          "order": 5,
          "source": "subnet_list",
          "groupBy": "group",
          "emptyText": "è¯·å…ˆé€‰æ‹©VPC"
        },
        "vpc_security_group_ids": {
          "widget": "multi-select",
          "label": "å®‰å…¨ç»„",
          "group": "basic",
          "order": 6,
          "source": "security_groups",
          "searchable": true,
          "emptyText": "è¯·å…ˆé€‰æ‹©VPC"
        },
        "kms_key_id": {
          "widget": "select",
          "label": "KMSå¯†é’¥",
          "group": "advanced",
          "order": 10,
          "source": "kms_keys",
          "searchable": true,
          "allowEmpty": true,
          "emptyLabel": "ä½¿ç”¨é»˜è®¤å¯†é’¥"
        }
      }
    }
  }
}
```

### 9.5 å­—æ®µUIé…ç½®æ‰©å±•å±æ€§

| å±æ€§ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `source` | string | ç»‘å®šçš„æ•°æ®æºID |
| `searchable` | boolean | æ˜¯å¦æ”¯æŒæœç´¢è¿‡æ»¤ |
| `allowCustom` | boolean | æ˜¯å¦å…è®¸è¾“å…¥è‡ªå®šä¹‰å€¼ |
| `customPlaceholder` | string | è‡ªå®šä¹‰è¾“å…¥çš„å ä½ç¬¦ |
| `groupBy` | string | æŒ‰æŒ‡å®šå­—æ®µåˆ†ç»„æ˜¾ç¤º |
| `renderOption` | object | è‡ªå®šä¹‰é€‰é¡¹æ¸²æŸ“æ¨¡æ¿ |
| `emptyText` | string | æ— æ•°æ®æ—¶æ˜¾ç¤ºçš„æ–‡æœ¬ |
| `allowEmpty` | boolean | æ˜¯å¦å…è®¸ç©ºå€¼ |
| `emptyLabel` | string | ç©ºå€¼é€‰é¡¹çš„æ˜¾ç¤ºæ–‡æœ¬ |

### 9.6 å®Œæ•´AMIå­—æ®µç¤ºä¾‹

```json
{
  "components": {
    "schemas": {
      "ModuleInput": {
        "properties": {
          "ami": {
            "type": "string",
            "title": "AMI",
            "description": "ID of AMI to use for the instance",
            "pattern": "^ami-[a-f0-9]{8,17}$",
            "x-validation": [
              {
                "condition": "var.ami == null || can(regex(\"^ami-\", var.ami))",
                "errorMessage": "AMI ID must start with 'ami-'.",
                "pattern": "^ami-"
              }
            ]
          }
        }
      }
    }
  },
  "x-iac-platform": {
    "external": {
      "sources": [
        {
          "id": "ami_list",
          "type": "api",
          "api": "/api/v1/aws/ec2/images",
          "method": "GET",
          "params": {
            "region": "${providers.aws.region}",
            "owners": "amazon,self",
            "architecture": "x86_64"
          },
          "cache": {
            "ttl": 300,
            "key": "ami_list_${providers.aws.region}"
          },
          "transform": {
            "type": "jmespath",
            "expression": "data.images[*].{value: image_id, label: name, description: description, created: creation_date}"
          }
        }
      ]
    },
    "ui": {
      "fields": {
        "ami": {
          "widget": "select",
          "label": "AMIé•œåƒ",
          "group": "basic",
          "order": 2,
          "help": "é€‰æ‹©EC2å®ä¾‹ä½¿ç”¨çš„AMIé•œåƒ",
          "source": "ami_list",
          "searchable": true,
          "allowCustom": true,
          "customPlaceholder": "æˆ–è¾“å…¥è‡ªå®šä¹‰AMI ID (ami-xxx)",
          "renderOption": {
            "template": "${label}",
            "description": "${description}",
            "meta": "åˆ›å»ºäº ${created}"
          }
        }
      }
    }
  }
}
```

### 9.7 Terraformæ³¨é‡Šä¸­å®šä¹‰æ•°æ®æº

åœ¨variables.tfä¸­ä½¿ç”¨æ³¨é‡Šå®šä¹‰æ•°æ®æºç»‘å®šï¼š

```hcl
variable "ami" {
  description = "ID of AMI to use"  # @level:basic source:ami_list widget:select searchable:true allowCustom:true
  type        = string
  default     = null
}

variable "instance_type" {
  description = "Instance type"  # @level:basic source:instance_types widget:select searchable:true
  type        = string
  default     = "t3.micro"
}

variable "subnet_id" {
  description = "Subnet ID"  # @level:basic source:subnet_list widget:select dependsOn:vpc_id
  type        = string
  default     = null
}
```

## 10. çº§è”è§„åˆ™è§„èŒƒ

çº§è”è§„åˆ™ç”¨äºå®ç°å­—æ®µé—´çš„è”åŠ¨æ•ˆæœï¼Œä¾‹å¦‚ï¼š
- é€‰æ‹©Aæ—¶ï¼Œè‡ªåŠ¨æ˜¾ç¤ºBã€Cã€Då­—æ®µ
- é€‰æ‹©Aæ—¶ï¼Œè‡ªåŠ¨éšè—Få­—æ®µ
- é€‰æ‹©Aæ—¶ï¼Œè‡ªåŠ¨è®¾ç½®Bå­—æ®µçš„å€¼
- é€‰æ‹©Aæ—¶ï¼Œç¦ç”¨Cå­—æ®µ

### 10.1 çº§è”è§„åˆ™ç»“æ„

```json
{
  "x-iac-platform": {
    "cascade": {
      "rules": [
        {
          "id": "rule-unique-id",
          "trigger": {
            "field": "trigger_field_name",
            "operator": "eq",
            "value": "trigger_value"
          },
          "actions": [
            {
              "type": "show",
              "fields": ["field1", "field2"]
            }
          ]
        }
      ]
    }
  }
}
```

### 10.2 è§¦å‘æ¡ä»¶ï¼ˆTriggerï¼‰

| å±æ€§ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `field` | string | æ˜¯ | è§¦å‘å­—æ®µåç§° |
| `operator` | string | æ˜¯ | æ¯”è¾ƒæ“ä½œç¬¦ |
| `value` | any | å¦ | æ¯”è¾ƒå€¼ï¼ˆæŸäº›æ“ä½œç¬¦ä¸éœ€è¦ï¼‰ |

**æ”¯æŒçš„æ“ä½œç¬¦ï¼š**

| æ“ä½œç¬¦ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|
| `eq` | ç­‰äº | `{ "operator": "eq", "value": true }` |
| `ne` | ä¸ç­‰äº | `{ "operator": "ne", "value": "" }` |
| `gt` | å¤§äº | `{ "operator": "gt", "value": 0 }` |
| `lt` | å°äº | `{ "operator": "lt", "value": 100 }` |
| `gte` | å¤§äºç­‰äº | `{ "operator": "gte", "value": 1 }` |
| `lte` | å°äºç­‰äº | `{ "operator": "lte", "value": 10 }` |
| `in` | åœ¨åˆ—è¡¨ä¸­ | `{ "operator": "in", "value": ["a", "b"] }` |
| `notIn` | ä¸åœ¨åˆ—è¡¨ä¸­ | `{ "operator": "notIn", "value": ["x", "y"] }` |
| `empty` | ä¸ºç©º | `{ "operator": "empty" }` |
| `notEmpty` | ä¸ä¸ºç©º | `{ "operator": "notEmpty" }` |
| `contains` | åŒ…å« | `{ "operator": "contains", "value": "kms" }` |
| `startsWith` | ä»¥...å¼€å¤´ | `{ "operator": "startsWith", "value": "ami-" }` |
| `endsWith` | ä»¥...ç»“å°¾ | `{ "operator": "endsWith", "value": ".json" }` |
| `matches` | æ­£åˆ™åŒ¹é… | `{ "operator": "matches", "value": "^ami-" }` |

### 10.3 åŠ¨ä½œç±»å‹ï¼ˆActionsï¼‰

| åŠ¨ä½œç±»å‹ | è¯´æ˜ | å‚æ•° |
|----------|------|------|
| `show` | æ˜¾ç¤ºå­—æ®µ | `fields`: å­—æ®µåæ•°ç»„ |
| `hide` | éšè—å­—æ®µ | `fields`: å­—æ®µåæ•°ç»„ |
| `enable` | å¯ç”¨å­—æ®µ | `fields`: å­—æ®µåæ•°ç»„ |
| `disable` | ç¦ç”¨å­—æ®µ | `fields`: å­—æ®µåæ•°ç»„, `message`: æç¤ºä¿¡æ¯ |
| `setValue` | è®¾ç½®å­—æ®µå€¼ | `field`: å­—æ®µå, `value`: å€¼ |
| `setOptions` | è®¾ç½®é€‰é¡¹åˆ—è¡¨ | `field`: å­—æ®µå, `options`: é€‰é¡¹æ•°ç»„ |
| `setRequired` | è®¾ç½®å¿…å¡« | `fields`: å­—æ®µåæ•°ç»„, `required`: boolean |
| `clearValue` | æ¸…ç©ºå­—æ®µå€¼ | `fields`: å­—æ®µåæ•°ç»„ |
| `reloadSource` | é‡æ–°åŠ è½½æ•°æ®æº | `fields`: å­—æ®µåæ•°ç»„ |

### 10.4 å®Œæ•´ç¤ºä¾‹

#### ç¤ºä¾‹1ï¼šå¯ç”¨å¯¹è±¡é”å®šæ—¶çš„çº§è”

```json
{
  "x-iac-platform": {
    "cascade": {
      "rules": [
        {
          "id": "object-lock-cascade",
          "description": "å¯ç”¨å¯¹è±¡é”å®šæ—¶ï¼Œæ˜¾ç¤ºé…ç½®é¡¹å¹¶å¼ºåˆ¶å¯ç”¨ç‰ˆæœ¬æ§åˆ¶",
          "trigger": {
            "field": "object_lock_enabled",
            "operator": "eq",
            "value": true
          },
          "actions": [
            {
              "type": "show",
              "fields": ["object_lock_configuration"]
            },
            {
              "type": "setValue",
              "field": "versioning.enabled",
              "value": true
            },
            {
              "type": "disable",
              "fields": ["versioning.enabled"],
              "message": "å¯¹è±¡é”å®šéœ€è¦ç‰ˆæœ¬æ§åˆ¶ï¼Œæ— æ³•ç¦ç”¨"
            }
          ]
        }
      ]
    }
  }
}
```

#### ç¤ºä¾‹2ï¼šé€‰æ‹©åŠ å¯†ç±»å‹æ—¶çš„çº§è”

```json
{
  "x-iac-platform": {
    "cascade": {
      "rules": [
        {
          "id": "kms-encryption-cascade",
          "description": "é€‰æ‹©KMSåŠ å¯†æ—¶ï¼Œæ˜¾ç¤ºKMSå¯†é’¥é€‰æ‹©å­—æ®µ",
          "trigger": {
            "field": "sse_algorithm",
            "operator": "eq",
            "value": "aws:kms"
          },
          "actions": [
            {
              "type": "show",
              "fields": ["kms_key_id", "kms_key_arn"]
            },
            {
              "type": "setRequired",
              "fields": ["kms_key_id"],
              "required": true
            }
          ]
        },
        {
          "id": "s3-encryption-cascade",
          "description": "é€‰æ‹©S3åŠ å¯†æ—¶ï¼Œéšè—KMSç›¸å…³å­—æ®µ",
          "trigger": {
            "field": "sse_algorithm",
            "operator": "eq",
            "value": "AES256"
          },
          "actions": [
            {
              "type": "hide",
              "fields": ["kms_key_id", "kms_key_arn"]
            },
            {
              "type": "clearValue",
              "fields": ["kms_key_id", "kms_key_arn"]
            }
          ]
        }
      ]
    }
  }
}
```

#### ç¤ºä¾‹3ï¼šVPCé€‰æ‹©ååŠ è½½å­ç½‘å’Œå®‰å…¨ç»„

```json
{
  "x-iac-platform": {
    "cascade": {
      "rules": [
        {
          "id": "vpc-selected-cascade",
          "description": "é€‰æ‹©VPCåï¼Œé‡æ–°åŠ è½½å­ç½‘å’Œå®‰å…¨ç»„åˆ—è¡¨",
          "trigger": {
            "field": "vpc_id",
            "operator": "notEmpty"
          },
          "actions": [
            {
              "type": "enable",
              "fields": ["subnet_id", "vpc_security_group_ids"]
            },
            {
              "type": "reloadSource",
              "fields": ["subnet_id", "vpc_security_group_ids"]
            }
          ]
        },
        {
          "id": "vpc-empty-cascade",
          "description": "æœªé€‰æ‹©VPCæ—¶ï¼Œç¦ç”¨å­ç½‘å’Œå®‰å…¨ç»„",
          "trigger": {
            "field": "vpc_id",
            "operator": "empty"
          },
          "actions": [
            {
              "type": "disable",
              "fields": ["subnet_id", "vpc_security_group_ids"],
              "message": "è¯·å…ˆé€‰æ‹©VPC"
            },
            {
              "type": "clearValue",
              "fields": ["subnet_id", "vpc_security_group_ids"]
            }
          ]
        }
      ]
    }
  }
}
```

#### ç¤ºä¾‹4ï¼šå®ä¾‹ç±»å‹å½±å“EBSä¼˜åŒ–é€‰é¡¹

```json
{
  "x-iac-platform": {
    "cascade": {
      "rules": [
        {
          "id": "ebs-optimized-auto",
          "description": "æŸäº›å®ä¾‹ç±»å‹é»˜è®¤å¯ç”¨EBSä¼˜åŒ–",
          "trigger": {
            "field": "instance_type",
            "operator": "matches",
            "value": "^(m5|c5|r5|t3)\\."
          },
          "actions": [
            {
              "type": "setValue",
              "field": "ebs_optimized",
              "value": true
            },
            {
              "type": "disable",
              "fields": ["ebs_optimized"],
              "message": "æ­¤å®ä¾‹ç±»å‹é»˜è®¤å¯ç”¨EBSä¼˜åŒ–"
            }
          ]
        }
      ]
    }
  }
}
```

### 10.5 Terraform æ³¨é‡Šä¸­å®šä¹‰çº§è”è§„åˆ™

åœ¨ variables.tf ä¸­ä½¿ç”¨æ³¨é‡Šå®šä¹‰ç®€å•çš„çº§è”å…³ç³»ï¼š

```hcl
variable "object_lock_enabled" {
  description = "Enable object lock"  # @level:advanced cascade_show:object_lock_configuration
  type        = bool
  default     = false
}

variable "sse_algorithm" {
  description = "Server-side encryption algorithm"  # @level:basic cascade_show_when:aws:kms=kms_key_id
  type        = string
  default     = "AES256"
}

variable "vpc_id" {
  description = "VPC ID"  # @level:basic cascade_reload:subnet_id,vpc_security_group_ids
  type        = string
  default     = null
}
```

**æ”¯æŒçš„çº§è”æ³¨é‡Šå±æ€§ï¼š**

| å±æ€§ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `cascade_show` | å½“å­—æ®µä¸ºtrueæ—¶æ˜¾ç¤º | `cascade_show:field1,field2` |
| `cascade_hide` | å½“å­—æ®µä¸ºtrueæ—¶éšè— | `cascade_hide:field1` |
| `cascade_show_when` | å½“å­—æ®µç­‰äºç‰¹å®šå€¼æ—¶æ˜¾ç¤º | `cascade_show_when:value=field1,field2` |
| `cascade_hide_when` | å½“å­—æ®µç­‰äºç‰¹å®šå€¼æ—¶éšè— | `cascade_hide_when:value=field1` |
| `cascade_reload` | å½“å­—æ®µå˜åŒ–æ—¶é‡æ–°åŠ è½½ | `cascade_reload:field1,field2` |
| `cascade_disable_when` | å½“å­—æ®µç­‰äºç‰¹å®šå€¼æ—¶ç¦ç”¨ | `cascade_disable_when:value=field1` |

### 10.6 çº§è”è§„åˆ™å®ç°çŠ¶æ€

| åŠŸèƒ½ | å®ç°çŠ¶æ€ | è¯´æ˜ |
|------|----------|------|
| **è§¦å‘æ¡ä»¶** | | |
| `eq` æ“ä½œç¬¦ | âœ… å·²å®ç° | CascadeEngine |
| `ne` æ“ä½œç¬¦ | âœ… å·²å®ç° | CascadeEngine |
| `gt/lt/gte/lte` æ“ä½œç¬¦ | âœ… å·²å®ç° | CascadeEngine |
| `in/notIn` æ“ä½œç¬¦ | âœ… å·²å®ç° | CascadeEngine |
| `empty/notEmpty` æ“ä½œç¬¦ | âœ… å·²å®ç° | CascadeEngine |
| `contains/startsWith/endsWith` æ“ä½œç¬¦ | âœ… å·²å®ç° | CascadeEngine |
| `matches` æ­£åˆ™æ“ä½œç¬¦ | âœ… å·²å®ç° | CascadeEngine |
| **åŠ¨ä½œç±»å‹** | | |
| `show` æ˜¾ç¤ºå­—æ®µ | âœ… å·²å®ç° | CascadeEngine + FormRenderer |
| `hide` éšè—å­—æ®µ | âœ… å·²å®ç° | CascadeEngine + FormRenderer |
| `enable` å¯ç”¨å­—æ®µ | âœ… å·²å®ç° | CascadeEngine + FormRenderer |
| `disable` ç¦ç”¨å­—æ®µ | âœ… å·²å®ç° | CascadeEngine + FormRendererï¼ˆæ”¯æŒç¦ç”¨åŸå› æç¤ºï¼‰ |
| `setValue` è®¾ç½®å€¼ | âœ… å·²å®ç° | CascadeEngine + FormRenderer |
| `setOptions` è®¾ç½®é€‰é¡¹ | âš ï¸ éƒ¨åˆ†å®ç° | CascadeEngine æ”¯æŒï¼ŒWidget å±‚é¢å¾…é›†æˆ |
| `setRequired` è®¾ç½®å¿…å¡« | âœ… å·²å®ç° | CascadeEngine + FormRenderer |
| `clearValue` æ¸…ç©ºå€¼ | âœ… å·²å®ç° | CascadeEngine + FormRenderer |
| `reloadSource` é‡æ–°åŠ è½½æ•°æ®æº | âš ï¸ éƒ¨åˆ†å®ç° | CascadeEngine æ”¯æŒï¼Œæ•°æ®æºå±‚é¢å¾…é›†æˆ |
| **å‰ç«¯é›†æˆ** | | |
| schema-form-renderer.html é¢„è§ˆ | âœ… å·²å®ç° | åŸºç¡€çº§è”åŠŸèƒ½ |
| React FormRenderer ç»„ä»¶ | âœ… å·²å®ç° | å®Œæ•´çº§è”åŠŸèƒ½ |
| çº§è”è§„åˆ™å¼•æ“ | âœ… å·²å®ç° | CascadeEngine ç±» |

### 10.7 çº§è”è§„åˆ™å¼€å‘ TODO

#### é«˜ä¼˜å…ˆçº§

1. **çº§è”è§„åˆ™å¼•æ“ï¼ˆCascadeEngineï¼‰**
   - è§£æçº§è”è§„åˆ™é…ç½®
   - ç›‘å¬å­—æ®µå€¼å˜åŒ–
   - æ‰§è¡Œçº§è”åŠ¨ä½œ
   - é¢„è®¡å·¥ä½œé‡ï¼š3å¤©

2. **åŸºç¡€æ“ä½œç¬¦æ”¯æŒ**
   - å®ç° eq, ne, empty, notEmpty æ“ä½œç¬¦
   - é¢„è®¡å·¥ä½œé‡ï¼š1å¤©

3. **åŸºç¡€åŠ¨ä½œæ”¯æŒ**
   - å®ç° show, hide, enable, disable, setValue åŠ¨ä½œ
   - é¢„è®¡å·¥ä½œé‡ï¼š2å¤©

4. **FormRenderer é›†æˆ**
   - åœ¨ React FormRenderer ä¸­é›†æˆçº§è”å¼•æ“
   - å­—æ®µå¯è§æ€§çŠ¶æ€ç®¡ç†
   - å­—æ®µç¦ç”¨çŠ¶æ€ç®¡ç†
   - é¢„è®¡å·¥ä½œé‡ï¼š2å¤©

#### ä¸­ä¼˜å…ˆçº§

5. **é«˜çº§æ“ä½œç¬¦æ”¯æŒ**
   - å®ç° gt, lt, gte, lte, in, notIn æ“ä½œç¬¦
   - å®ç° contains, startsWith, endsWith, matches æ“ä½œç¬¦
   - é¢„è®¡å·¥ä½œé‡ï¼š2å¤©

6. **é«˜çº§åŠ¨ä½œæ”¯æŒ**
   - å®ç° setOptions, setRequired, clearValue åŠ¨ä½œ
   - å®ç° reloadSource åŠ¨ä½œï¼ˆä¸å¤–éƒ¨æ•°æ®æºé›†æˆï¼‰
   - é¢„è®¡å·¥ä½œé‡ï¼š2å¤©

7. **tf2openapi å·¥å…·æ”¯æŒ**
   - è§£æ Terraform æ³¨é‡Šä¸­çš„çº§è”è§„åˆ™
   - ç”Ÿæˆçº§è”è§„åˆ™é…ç½®
   - é¢„è®¡å·¥ä½œé‡ï¼š1å¤©

#### ä½ä¼˜å…ˆçº§

8. **å¤æ‚æ¡ä»¶æ”¯æŒ**
   - æ”¯æŒ AND/OR ç»„åˆæ¡ä»¶
   - æ”¯æŒåµŒå¥—æ¡ä»¶
   - é¢„è®¡å·¥ä½œé‡ï¼š2å¤©

9. **çº§è”è§„åˆ™å¯è§†åŒ–ç¼–è¾‘å™¨**
   - åœ¨ Schema ç¼–è¾‘å™¨ä¸­å¯è§†åŒ–é…ç½®çº§è”è§„åˆ™
   - é¢„è®¡å·¥ä½œé‡ï¼š3å¤©

## 11. å®Œæ•´ç¤ºä¾‹

### 11.1 EC2æ¨¡å—Schemaï¼ˆç®€åŒ–ç‰ˆï¼‰

```json
{
  "openapi": "3.1.0",
  "info": {
    "title": "AWS EC2 Instance",
    "version": "5.0.0",
    "description": "Terraform module: AWS EC2 Instance",
    "x-module-source": "terraform-aws-modules/ec2-instance/aws",
    "x-provider": "aws"
  },
  "components": {
    "schemas": {
      "ModuleInput": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "title": "Name",
            "description": "Name to be used on EC2 instance created",
            "default": ""
          },
          "ami": {
            "type": "string",
            "title": "Ami",
            "description": "ID of AMI to use for the instance",
            "pattern": "^ami-",
            "x-validation": [
              {
                "condition": "var.ami == null || can(regex(\"^ami-\", var.ami))",
                "errorMessage": "AMI ID must start with 'ami-'.",
                "pattern": "^ami-"
              }
            ]
          },
          "instance_type": {
            "type": "string",
            "title": "Instance Type",
            "description": "The type of instance to start",
            "default": "t3.micro"
          },
          "vpc_security_group_ids": {
            "type": "array",
            "title": "Vpc Security Group Ids",
            "description": "A list of security group IDs to associate with",
            "items": {
              "type": "string"
            }
          },
          "tags": {
            "type": "object",
            "title": "Tags",
            "description": "A mapping of tags to assign to the resource",
            "default": {},
            "additionalProperties": {
              "type": "string"
            }
          }
        },
        "required": []
      }
    }
  },
  "x-iac-platform": {
    "ui": {
      "fields": {
        "name": {
          "widget": "text",
          "label": "Name",
          "group": "basic",
          "order": 1,
          "help": "Name to be used on EC2 instance created"
        },
        "ami": {
          "widget": "text",
          "label": "Ami",
          "group": "basic",
          "order": 2,
          "help": "ID of AMI to use for the instance"
        },
        "instance_type": {
          "widget": "text",
          "label": "Instance Type",
          "group": "basic",
          "order": 3,
          "help": "The type of instance to start"
        },
        "vpc_security_group_ids": {
          "widget": "tags",
          "label": "Vpc Security Group Ids",
          "group": "basic",
          "order": 4,
          "help": "A list of security group IDs to associate with"
        },
        "tags": {
          "widget": "key-value",
          "label": "Tags",
          "group": "basic",
          "order": 5,
          "help": "A mapping of tags to assign to the resource"
        }
      },
      "groups": [
        {
          "id": "basic",
          "title": "åŸºç¡€é…ç½®",
          "icon": "settings",
          "order": 1,
          "defaultExpanded": true
        },
        {
          "id": "advanced",
          "title": "é«˜çº§é…ç½®",
          "icon": "code",
          "order": 2,
          "hiddenByDefault": true
        }
      ],
      "layout": {
        "type": "tabs",
        "position": "top"
      }
    }
  }
}
```

## 12. å‰ç«¯å®ç°

### 12.1 è¡¨å•æ¸²æŸ“å™¨æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ModuleFormContainer                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                    SchemaProvider                        â”‚â”‚
â”‚  â”‚  - è§£æOpenAPI Schema                                    â”‚â”‚
â”‚  â”‚  - ç®¡ç†è¡¨å•çŠ¶æ€                                          â”‚â”‚
â”‚  â”‚  - å¤„ç†éªŒè¯é€»è¾‘                                          â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                    FormLayout (Tabs)                     â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚â”‚
â”‚  â”‚  â”‚  åŸºç¡€é…ç½®   â”‚ â”‚  é«˜çº§é…ç½®   â”‚                        â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                        â”‚â”‚
â”‚  â”‚         â”‚               â”‚                                â”‚â”‚
â”‚  â”‚         â–¼               â–¼                                â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚â”‚
â”‚  â”‚  â”‚                  FieldRenderer                       â”‚â”‚â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚â”‚â”‚
â”‚  â”‚  â”‚  â”‚TextField â”‚ â”‚TagsField â”‚ â”‚KeyValue  â”‚  ...       â”‚â”‚â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 12.2 Widgetç»„ä»¶æ˜ å°„

| Widgetç±»å‹ | ç»„ä»¶ | æ•°æ®ç±»å‹ |
|------------|------|----------|
| `text` | `<input type="text">` | string |
| `number` | `<input type="number">` | number |
| `switch` | `<Switch>` | boolean |
| `select` | `<Select>` | string (enum) |
| `tags` | `<TagsEditor>` | array[string] |
| `key-value` | `<KeyValueEditor>` | object |
| `object` | `<ObjectEditor>` | object |
| `object-list` | `<ObjectListEditor>` | array[object] |
| `password` | `<input type="password">` | string (sensitive) |

### 12.3 éªŒè¯æµç¨‹

```
ç”¨æˆ·è¾“å…¥ â†’ å­—æ®µçº§éªŒè¯ â†’ è·¨å­—æ®µéªŒè¯ â†’ æäº¤éªŒè¯
    â”‚           â”‚              â”‚            â”‚
    â”‚           â–¼              â–¼            â–¼
    â”‚      patternæ£€æŸ¥    conflictsæ£€æŸ¥   requiredæ£€æŸ¥
    â”‚      min/maxæ£€æŸ¥    requiredWith    asyncéªŒè¯
    â”‚      formatæ£€æŸ¥     exactlyOneOf
    â”‚                     atLeastOneOf
    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ æ˜¾ç¤ºé”™è¯¯
```

## 13. åç«¯APIè®¾è®¡

### 13.1 Schema API

```yaml
# è·å–æ¨¡å—Schema
GET /api/v1/modules/{moduleId}/schema
Response:
  200:
    content:
      application/json:
        schema:
          $ref: '#/components/schemas/ModuleSchemaResponse'

# éªŒè¯æ¨¡å—è¾“å…¥
POST /api/v1/modules/{moduleId}/validate
Request:
  content:
    application/json:
      schema:
        type: object
        properties:
          values:
            type: object
          mode:
            type: string
            enum: [create, update]
Response:
  200:
    content:
      application/json:
        schema:
          type: object
          properties:
            valid:
              type: boolean
            errors:
              type: array
```

## 14. è¿ç§»ç­–ç•¥

### 14.1 è¿ç§»æ­¥éª¤

1. **Phase 1: å·¥å…·å‡†å¤‡** âœ…
   - å¼€å‘tf2openapiè½¬æ¢å·¥å…·
   - å®šä¹‰æ³¨é‡Šè§„èŒƒ
   - åˆ›å»ºç¤ºä¾‹Schema

2. **Phase 2: å‰ç«¯é€‚é…**
   - å¼€å‘Schemaé©±åŠ¨çš„è¡¨å•æ¸²æŸ“å™¨
   - æ”¯æŒæ‰€æœ‰Widgetç±»å‹
   - å®ç°éªŒè¯é€»è¾‘

3. **Phase 3: åç«¯é›†æˆ**
   - å®ç°Schema API
   - é›†æˆéªŒè¯æœåŠ¡
   - æ”¯æŒå¤–éƒ¨æ•°æ®æº

4. **Phase 4: æ¨¡å—è¿ç§»**
   - æ‰¹é‡è½¬æ¢ç°æœ‰æ¨¡å—
   - äººå·¥å®¡æ ¸å’Œè°ƒæ•´
   - é€æ­¥ä¸Šçº¿

### 14.2 å…¼å®¹æ€§è€ƒè™‘

- ä¿æŒæ—§Schemaæ ¼å¼æ”¯æŒ
- æä¾›è‡ªåŠ¨è½¬æ¢å·¥å…·
- åˆ†é˜¶æ®µè¿ç§»ï¼Œé™ä½é£é™©

## 15. æ€»ç»“

### 15.1 æ–°æ–¹æ¡ˆä¼˜åŠ¿

| ç‰¹æ€§ | æ—§æ–¹æ¡ˆ | æ–°æ–¹æ¡ˆ |
|------|--------|--------|
| ç±»å‹ç³»ç»Ÿ | è‡ªå®šä¹‰æšä¸¾ | æ ‡å‡†JSON Schema |
| éªŒè¯è§„åˆ™ | åˆ†æ•£åœ¨å„å­—æ®µ | é›†ä¸­ç®¡ç†ï¼Œæ”¯æŒè·¨å­—æ®µ |
| UIé…ç½® | æ··åœ¨æ•°æ®Schemaä¸­ | ç‹¬ç«‹çš„UIå±‚ |
| çº§è”è§„åˆ™ | ä¸æ”¯æŒ | å®Œæ•´æ”¯æŒ |
| å·¥å…·æ”¯æŒ | æ—  | tf2openapiè‡ªåŠ¨è½¬æ¢ |
| æ ‡å‡†åŒ– | ç§æœ‰æ ¼å¼ | OpenAPI 3.1æ ‡å‡† |

### 15.2 å·²å®Œæˆå·¥ä½œ

- âœ… tf2openapiè½¬æ¢å·¥å…·
- âœ… Terraformæ³¨é‡Šè§„èŒƒ
- âœ… Schemaè¡¨å•æ¸²æŸ“å™¨é¢„è§ˆ
- âœ… EC2/S3æ¨¡å—ç¤ºä¾‹Schema
- âœ… åŸºç¡€Widgetæ”¯æŒï¼ˆtext, number, switch, tags, key-valueï¼‰
- âœ… éªŒè¯è§„åˆ™æ”¯æŒï¼ˆpattern, required, minimum, maximum, minLength, maxLength, enumï¼‰
- âœ… åˆ†ç»„å’ŒTabå¸ƒå±€
- âœ… å‰ç«¯æ­£å¼ç»„ä»¶å¼€å‘ï¼ˆOpenAPIFormRendererï¼‰
- âœ… çº§è”è§„åˆ™å¼•æ“ï¼ˆCascadeEngineï¼‰
- âœ… åç«¯Schema APIï¼ˆGetSchemaV2, CreateSchemaV2, UpdateSchemaV2, ValidateModuleInputï¼‰
- âœ… é«˜çº§Widgetç±»å‹ï¼ˆobject, object-list, dynamic-object, json-editor, password, datetime, code-editorï¼‰
- âœ… è·¨å­—æ®µéªŒè¯è§„åˆ™ï¼ˆconflicts, requiredWith, exactlyOneOf, atLeastOneOfï¼‰

### 15.3 å¾…å®Œæˆå·¥ä½œ

- [ ] æ‰¹é‡æ¨¡å—è¿ç§»
- [ ] file-upload Widget

### 15.4 å¤–éƒ¨æ•°æ®æºå®ç°çŠ¶æ€

| åŠŸèƒ½ | å®ç°çŠ¶æ€ | è¯´æ˜ |
|------|----------|------|
| **ExternalDataSourceManager** | âœ… å·²å®ç° | æ•°æ®æºç®¡ç†å™¨ç±» |
| API æ•°æ®æºåŠ è½½ | âœ… å·²å®ç° | æ”¯æŒ GET/POST è¯·æ±‚ |
| é™æ€æ•°æ®æº | âœ… å·²å®ç° | ç›´æ¥ä½¿ç”¨é…ç½®çš„æ•°æ® |
| å˜é‡æ›¿æ¢ | âœ… å·²å®ç° | æ”¯æŒ ${providers.xxx}ã€${fields.xxx}ã€${workspace.id}ã€${organization.id} |
| ç¼“å­˜æœºåˆ¶ | âœ… å·²å®ç° | æ”¯æŒ TTL å’Œè‡ªå®šä¹‰ç¼“å­˜é”® |
| ä¾èµ–åˆ·æ–° | âœ… å·²å®ç° | å½“ä¾èµ–å­—æ®µå˜åŒ–æ—¶è‡ªåŠ¨åˆ·æ–° |
| JMESPath è½¬æ¢ | âœ… å·²å®ç° | ç®€åŒ–å®ç°ï¼Œæ”¯æŒåŸºæœ¬è·¯å¾„è®¿é—® |
| JSONPath è½¬æ¢ | âœ… å·²å®ç° | ç®€åŒ–å®ç° |
| **useExternalDataSource Hook** | âœ… å·²å®ç° | React Hook å°è£… |
| useSingleDataSource | âœ… å·²å®ç° | å•ä¸ªæ•°æ®æº Hook |
| useFieldDataSource | âœ… å·²å®ç° | å­—æ®µæ•°æ®æº Hook |
| Terraform æ•°æ®æº | âŒ æœªå®ç° | ä½ä¼˜å…ˆçº§ |

### 15.4 å·²çŸ¥é—®é¢˜ (Known Issues)

| é—®é¢˜ | ä¼˜å…ˆçº§ | è¯´æ˜ |
|------|--------|------|
| **é»˜è®¤å€¼æ¸²æŸ“å¤±æ•ˆ** | ğŸ”´ é«˜ | Schema ä¸­å®šä¹‰çš„ `default` å€¼æœªèƒ½æ­£ç¡®æ¸²æŸ“åˆ°è¡¨å•ä¸­ï¼Œéœ€è¦ä¿®å¤ FormRenderer çš„ initialValues å¤„ç†é€»è¾‘ |
| çº§è”è§„åˆ™æœªé›†æˆåˆ° React ç»„ä»¶ | ğŸŸ¡ ä¸­ | çº§è”è§„åˆ™ä»…åœ¨ HTML é¢„è§ˆä¸­å®ç°ï¼ŒReact FormRenderer å°šæœªé›†æˆ |
| Object/ObjectList Widget æœªå®Œæ•´å®ç° | ğŸŸ¡ ä¸­ | æš‚æ—¶å¤ç”¨ KeyValueWidgetï¼Œéœ€è¦å¼€å‘ä¸“é—¨çš„ç»„ä»¶ |

### 15.5 Bug ä¿®å¤ TODO

#### ğŸ”´ é«˜ä¼˜å…ˆçº§

1. **é»˜è®¤å€¼æ¸²æŸ“å¤±æ•ˆä¿®å¤**
   - **é—®é¢˜æè¿°**ï¼šSchema ä¸­å®šä¹‰çš„ `default` å±æ€§å€¼æœªèƒ½æ­£ç¡®æ˜¾ç¤ºåœ¨è¡¨å•å­—æ®µä¸­
   - **å½±å“èŒƒå›´**ï¼šæ‰€æœ‰ Widget ç±»å‹
   - **æ ¹æœ¬åŸå› **ï¼šFormRenderer ç»„ä»¶çš„ `initialValues` å¤„ç†é€»è¾‘æœªæ­£ç¡®ä» Schema ä¸­æå–é»˜è®¤å€¼
   - **ä¿®å¤æ–¹æ¡ˆ**ï¼š
     1. åœ¨ FormRenderer åˆå§‹åŒ–æ—¶ï¼Œéå† Schema properties æå–æ‰€æœ‰ default å€¼
     2. å°†æå–çš„é»˜è®¤å€¼ä¸ä¼ å…¥çš„ initialValues åˆå¹¶
     3. ç¡®ä¿å„ Widget ç»„ä»¶æ­£ç¡®æ¥æ”¶å’Œæ˜¾ç¤ºé»˜è®¤å€¼
   - **é¢„è®¡å·¥ä½œé‡**ï¼š0.5å¤©
   - **ç›¸å…³æ–‡ä»¶**ï¼š
     - `frontend/src/components/OpenAPIFormRenderer/FormRenderer.tsx`
     - `frontend/src/components/OpenAPIFormRenderer/widgets/*.tsx`

2. **é»˜è®¤å€¼æœªæŒ‰å€¼ç±»å‹æ¸²æŸ“**
   - **é—®é¢˜æè¿°**ï¼šé»˜è®¤å€¼åœ¨æ¸²æŸ“æ—¶æœªæ ¹æ® ValueType è¿›è¡Œæ­£ç¡®çš„ç±»å‹è½¬æ¢å’Œæ ¼å¼åŒ–
   - **å½±å“èŒƒå›´**ï¼šæ‰€æœ‰ Widget ç±»å‹
   - **å…·ä½“é—®é¢˜**ï¼š
     | ValueType | é—®é¢˜ | æœŸæœ›è¡Œä¸º |
     |-----------|------|----------|
     | TypeBool (1) | é»˜è®¤å€¼ `false` å¯èƒ½è¢«å¿½ç•¥ | åº”æ­£ç¡®æ¸²æŸ“ä¸ºå…³é—­çŠ¶æ€çš„å¼€å…³ |
     | TypeInt (2) | é»˜è®¤å€¼ `0` å¯èƒ½è¢«å¿½ç•¥ | åº”æ­£ç¡®æ˜¾ç¤ºæ•°å­— 0 |
     | TypeFloat (3) | é»˜è®¤å€¼ `0.0` å¯èƒ½è¢«å¿½ç•¥ | åº”æ­£ç¡®æ˜¾ç¤ºæµ®ç‚¹æ•° 0.0 |
     | TypeString (4) | é»˜è®¤å€¼ `""` ç©ºå­—ç¬¦ä¸²å¤„ç†ä¸ä¸€è‡´ | åº”æ˜¾ç¤ºç©ºè¾“å…¥æ¡† |
     | TypeList (5) | é»˜è®¤å€¼ `[]` ç©ºæ•°ç»„å¤„ç†ä¸ä¸€è‡´ | åº”æ˜¾ç¤ºç©ºæ ‡ç­¾åˆ—è¡¨ |
     | TypeMap (6) | é»˜è®¤å€¼ `{}` ç©ºå¯¹è±¡å¤„ç†ä¸ä¸€è‡´ | åº”æ˜¾ç¤ºç©ºé”®å€¼å¯¹ç¼–è¾‘å™¨ |
     | TypeObject (8) | åµŒå¥—å¯¹è±¡çš„é»˜è®¤å€¼æœªé€’å½’å¤„ç† | åº”é€’å½’æå–å¹¶æ¸²æŸ“åµŒå¥—é»˜è®¤å€¼ |
     | TypeListObject (11) | å¯¹è±¡æ•°ç»„çš„é»˜è®¤å€¼æœªæ­£ç¡®æ¸²æŸ“ | åº”æ¸²æŸ“é»˜è®¤çš„å¯¹è±¡åˆ—è¡¨é¡¹ |
   - **ä¿®å¤æ–¹æ¡ˆ**ï¼š
     1. åœ¨æå–é»˜è®¤å€¼æ—¶ï¼Œæ ¹æ® ValueType è¿›è¡Œç±»å‹æ£€æŸ¥å’Œè½¬æ¢
     2. åŒºåˆ† `undefined`ï¼ˆæœªè®¾ç½®ï¼‰å’Œ `null`/`false`/`0`/`""`/`[]`/`{}`ï¼ˆæœ‰æ•ˆé»˜è®¤å€¼ï¼‰
     3. å„ Widget ç»„ä»¶éœ€è¦æ­£ç¡®å¤„ç† falsy å€¼ä½œä¸ºæœ‰æ•ˆé»˜è®¤å€¼
   - **é¢„è®¡å·¥ä½œé‡**ï¼š1å¤©
   - **ç›¸å…³æ–‡ä»¶**ï¼š
     - `frontend/src/components/OpenAPIFormRenderer/FormRenderer.tsx`
     - `frontend/src/components/OpenAPIFormRenderer/widgets/*.tsx`
     - `frontend/src/services/schemaV2.ts`

```typescript
// ä¿®å¤ç¤ºä¾‹ä»£ç  - æŒ‰å€¼ç±»å‹æå–é»˜è®¤å€¼
const extractDefaultValues = (schema: OpenAPIFormSchema): Record<string, unknown> => {
  const properties = schema.components?.schemas?.ModuleInput?.properties || {};
  const defaults: Record<string, unknown> = {};
  
  Object.entries(properties).forEach(([name, prop]) => {
    // å…³é”®ï¼šä½¿ç”¨ hasOwnProperty æ£€æŸ¥ï¼Œè€Œä¸æ˜¯æ£€æŸ¥å€¼æ˜¯å¦ä¸º truthy
    if (Object.prototype.hasOwnProperty.call(prop, 'default')) {
      const defaultValue = prop.default;
      const valueType = getValueType(prop);
      
      // æ ¹æ®å€¼ç±»å‹è¿›è¡Œè½¬æ¢
      switch (valueType) {
        case ValueType.TypeBool:
          // boolean ç±»å‹ï¼šfalse æ˜¯æœ‰æ•ˆå€¼
          defaults[name] = Boolean(defaultValue);
          break;
        case ValueType.TypeInt:
          // integer ç±»å‹ï¼š0 æ˜¯æœ‰æ•ˆå€¼
          defaults[name] = defaultValue !== null ? Number(defaultValue) : 0;
          break;
        case ValueType.TypeFloat:
          // float ç±»å‹ï¼š0.0 æ˜¯æœ‰æ•ˆå€¼
          defaults[name] = defaultValue !== null ? parseFloat(defaultValue) : 0.0;
          break;
        case ValueType.TypeString:
        case ValueType.TypeText:
        case ValueType.TypeJsonString:
          // string ç±»å‹ï¼šç©ºå­—ç¬¦ä¸²æ˜¯æœ‰æ•ˆå€¼
          defaults[name] = defaultValue ?? '';
          break;
        case ValueType.TypeList:
        case ValueType.TypeSet:
        case ValueType.TypeListObject:
          // array ç±»å‹ï¼šç©ºæ•°ç»„æ˜¯æœ‰æ•ˆå€¼
          defaults[name] = Array.isArray(defaultValue) ? defaultValue : [];
          break;
        case ValueType.TypeMap:
        case ValueType.TypeObject:
        case ValueType.CustomObject:
          // object ç±»å‹ï¼šç©ºå¯¹è±¡æ˜¯æœ‰æ•ˆå€¼ï¼Œéœ€è¦é€’å½’å¤„ç†åµŒå¥—é»˜è®¤å€¼
          if (prop.properties) {
            defaults[name] = extractNestedDefaults(prop, defaultValue);
          } else {
            defaults[name] = defaultValue ?? {};
          }
          break;
        default:
          defaults[name] = defaultValue;
      }
    }
  });
  
  return defaults;
};

// é€’å½’æå–åµŒå¥—å¯¹è±¡çš„é»˜è®¤å€¼
const extractNestedDefaults = (prop: PropertySchema, parentDefault: unknown): Record<string, unknown> => {
  const result: Record<string, unknown> = {};
  const properties = prop.properties || {};
  const defaultObj = (parentDefault && typeof parentDefault === 'object') ? parentDefault : {};
  
  Object.entries(properties).forEach(([key, nestedProp]) => {
    if (Object.prototype.hasOwnProperty.call(nestedProp, 'default')) {
      result[key] = nestedProp.default;
    } else if (Object.prototype.hasOwnProperty.call(defaultObj, key)) {
      result[key] = (defaultObj as Record<string, unknown>)[key];
    }
  });
  
  return result;
};

// åœ¨ FormRenderer ä¸­ä½¿ç”¨
const defaultValues = useMemo(() => {
  const schemaDefaults = extractDefaultValues(schema);
  // ç”¨æˆ·ä¼ å…¥çš„ initialValues ä¼˜å…ˆçº§æ›´é«˜
  return { ...schemaDefaults, ...initialValues };
}, [schema, initialValues]);
```

**Widget ç»„ä»¶ä¿®å¤è¦ç‚¹ï¼š**

```typescript
// SwitchWidget - æ­£ç¡®å¤„ç† false é»˜è®¤å€¼
const SwitchWidget: React.FC<WidgetProps> = ({ value, schema }) => {
  // ä½¿ç”¨ ?? è€Œä¸æ˜¯ ||ï¼Œç¡®ä¿ false ä¸ä¼šè¢«è¦†ç›–
  const checked = value ?? schema.default ?? false;
  return <Switch checked={checked} />;
};

// NumberWidget - æ­£ç¡®å¤„ç† 0 é»˜è®¤å€¼
const NumberWidget: React.FC<WidgetProps> = ({ value, schema }) => {
  // ä½¿ç”¨ ?? è€Œä¸æ˜¯ ||ï¼Œç¡®ä¿ 0 ä¸ä¼šè¢«è¦†ç›–
  const numValue = value ?? schema.default ?? 0;
  return <InputNumber value={numValue} />;
};

// TagsWidget - æ­£ç¡®å¤„ç†ç©ºæ•°ç»„é»˜è®¤å€¼
const TagsWidget: React.FC<WidgetProps> = ({ value, schema }) => {
  // ç¡®ä¿ç©ºæ•°ç»„ä¹Ÿèƒ½æ­£ç¡®æ¸²æŸ“
  const tags = Array.isArray(value) ? value : (Array.isArray(schema.default) ? schema.default : []);
  return <TagsEditor value={tags} />;
};

// KeyValueWidget - æ­£ç¡®å¤„ç†ç©ºå¯¹è±¡é»˜è®¤å€¼
const KeyValueWidget: React.FC<WidgetProps> = ({ value, schema }) => {
  // ç¡®ä¿ç©ºå¯¹è±¡ä¹Ÿèƒ½æ­£ç¡®æ¸²æŸ“
  const kvData = (value && typeof value === 'object') ? value : (schema.default ?? {});
  return <KeyValueEditor value={kvData} />;
};
```

#### ğŸŸ¡ ä¸­ä¼˜å…ˆçº§

2. **Switch Widget é»˜è®¤å€¼å¤„ç†**
   - ç¡®ä¿ boolean ç±»å‹çš„ default: false ä¹Ÿèƒ½æ­£ç¡®æ¸²æŸ“
   - åŒºåˆ† undefined å’Œ false çš„æƒ…å†µ

3. **Select Widget é»˜è®¤å€¼å¤„ç†**
   - ç¡®ä¿ enum ç±»å‹çš„é»˜è®¤å€¼èƒ½æ­£ç¡®é€‰ä¸­
   - å¤„ç† default å€¼ä¸åœ¨ enum åˆ—è¡¨ä¸­çš„è¾¹ç¼˜æƒ…å†µ

4. **Tags Widget é»˜è®¤å€¼å¤„ç†**
   - ç¡®ä¿æ•°ç»„ç±»å‹çš„é»˜è®¤å€¼èƒ½æ­£ç¡®æ¸²æŸ“ä¸ºæ ‡ç­¾
   - å¤„ç†ç©ºæ•°ç»„ `[]` çš„æƒ…å†µ

5. **KeyValue Widget é»˜è®¤å€¼å¤„ç†**
   - ç¡®ä¿å¯¹è±¡ç±»å‹çš„é»˜è®¤å€¼èƒ½æ­£ç¡®æ¸²æŸ“ä¸ºé”®å€¼å¯¹
   - å¤„ç†ç©ºå¯¹è±¡ `{}` çš„æƒ…å†µ
